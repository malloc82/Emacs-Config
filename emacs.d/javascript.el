



<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
        <title>chrome/content/javascript.el at master from bard's mozrepl - GitHub</title>
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub" />
    <link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub" />

    
      <link href="http://assets1.github.com/stylesheets/bundle.css?8b1947b11f48aeea99482e16097d5cf260845cde" media="screen" rel="stylesheet" type="text/css" />
    

    
      
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
        <script src="http://assets0.github.com/javascripts/bundle.js?8b1947b11f48aeea99482e16097d5cf260845cde" type="text/javascript"></script>
      
    
    
  
    
  

  <link href="http://github.com/feeds/bard/commits/mozrepl/master" rel="alternate" title="Recent Commits to mozrepl:master" type="application/atom+xml" />

  <meta name="description" content="" />


    

    <script type="text/javascript">
      github_user = null
    </script>
  </head>

  

  <body>
    

    <div id="main">
      <div id="header" class="">
        <div class="site">
          <div class="logo">
            <a href="http://github.com"><img src="/images/modules/header/logov3.png" alt="github" /></a>
          </div>
          
            <div class="topsearch">
  <form action="/search" id="top_search_form" method="get">
    <input type="search" class="search" name="q" /> <input type="submit" value="Search" />
    <input type="hidden" name="type" value="Everything" />
    <input type="hidden" name="repo" value="" />
    <input type="hidden" name="langOverride" value="" />
    <input type="hidden" name="start_value" value="1" />
  </form>
  <div class="links">
    <a href="/repositories">Browse</a> | <a href="/guides">Guides</a> | <a href="/search">Advanced</a>
  </div>
</div>
          
          
            <div class="actions">
              <a href="http://github.com/">Home</a>
              <a href="/plans"><b><u>Pricing and Signup</u></b></a>
              <a href="http://github.com/popular/forked">Repositories</a>
              
              <a href="/blog">Blog</a>
              <a href="/login">Login</a>
            </div>
          
        </div>
      </div>
      
      
        
    <div id="repo_menu">
      <div class="site">
        <ul>
          
            <li class="active"><a href="http://github.com/bard/mozrepl/tree/master">Source</a></li>

            <li class=""><a href="http://github.com/bard/mozrepl/commits/master">Commits</a></li>

            <li class=""><a href="/bard/mozrepl/network">Network (3)</a></li>

            

            

            <li class=""><a href="/bard/mozrepl/downloads">Downloads (11)</a></li>

            <li class=""><a href="http://wiki.github.com/bard/mozrepl">Wiki (17)</a></li>

            <li class=""><a href="/bard/mozrepl/graphs">Graphs</a></li>

            

          
        </ul>
      </div>
    </div>

  <div id="repo_sub_menu">
    <div class="site">
      <div class="joiner"></div>
      

      

      

      
    </div>
  </div>

  <div class="site">
    





<div id="repos">
  


<script type="text/javascript">
  GitHub.currentCommitRef = "master"
</script>



  <div class="repo public">
    <div class="title">
      <div class="path">
        <a href="/bard">bard</a> / <b><a href="http://github.com/bard/mozrepl/tree">mozrepl</a></b>

        

          

          
            

            
              
            
          

          <a href="/signup" class="toggle_watch"><img alt="watch" class="button" src="http://assets1.github.com/images/modules/repos/watch_button.png?8d03715d4982b13666d8c8cd51a9310d0a530e2c" /></a><a href="/signup" class="toggle_watch" style="display:none;"><img alt="watch" class="button" src="http://assets0.github.com/images/modules/repos/unwatch_button.png?8d03715d4982b13666d8c8cd51a9310d0a530e2c" /></a>

          
            <a href="#" id="download_button" rel="bard/mozrepl"><img alt="download tarball" class="button" src="http://assets0.github.com/images/modules/repos/download_button.png?8d03715d4982b13666d8c8cd51a9310d0a530e2c" /></a>
          
        
      </div>

      <div class="security private_security" style="display:none">
        <a href="#private_repo" rel="facebox"><img src="/images/icons/private.png" alt="private" /></a>
      </div>

      <div id="private_repo" class="hidden">
        This repository is private.
        All pages are served over SSL and all pushing and pulling is done over SSH.
        No one may fork, clone, or view it unless they are added as a <a href="/bard/mozrepl/edit">member</a>.

        <br/>
        <br/>
        Every repository with this icon (<img src="/images/icons/private.png" alt="private" />) is private.
      </div>

      <div class="security public_security" style="">
        <a href="#public_repo" rel="facebox"><img src="/images/icons/public.png" alt="public" /></a>
      </div>

      <div id="public_repo" class="hidden">
        This repository is public.
        Anyone may fork, clone, or view it.

        <br/>
        <br/>
        Every repository with this icon (<img src="/images/icons/public.png" alt="public" />) is public.
      </div>

      

      <div class="flexipill">
        <a href="/bard/mozrepl/network">
        <table cellpadding="0" cellspacing="0">
          <tr><td><img alt="Forks" src="http://assets2.github.com/images/modules/repos/pills/forks.png?8d03715d4982b13666d8c8cd51a9310d0a530e2c" /></td><td class="middle"><span>3</span></td><td><img alt="Right" src="http://assets3.github.com/images/modules/repos/pills/right.png?8d03715d4982b13666d8c8cd51a9310d0a530e2c" /></td></tr>
        </table>
        </a>
      </div>

      <div class="flexipill">
        <a href="/bard/mozrepl/watchers">
        <table cellpadding="0" cellspacing="0">
          <tr><td><img alt="Watchers" src="http://assets2.github.com/images/modules/repos/pills/watchers.png?8d03715d4982b13666d8c8cd51a9310d0a530e2c" /></td><td class="middle"><span>38</span></td><td><img alt="Right" src="http://assets3.github.com/images/modules/repos/pills/right.png?8d03715d4982b13666d8c8cd51a9310d0a530e2c" /></td></tr>
        </table>
        </a>
      </div>
    </div>
    <div class="meta">
      <table>
        
        

        
          

          
            <tr>
              <td class="label">Clone&nbsp;URL:</td>
              
              <td>
                <a href="git://github.com/bard/mozrepl.git" class="git_url_facebox" rel="#git-clone">git://github.com/bard/mozrepl.git</a>
                      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"
              width="110"
              height="14"
              id="clippy" >
      <param name="movie" value="/flash/clippy.swf"/>
      <param name="allowScriptAccess" value="always" />
      <param name="quality" value="high" />
      <param name="scale" value="noscale" />
      <param NAME="FlashVars" value="text=git://github.com/bard/mozrepl.git">
      <param name="bgcolor" value="#F0F0F0">
      <param name="wmode" value="opaque">
      <embed src="/flash/clippy.swf"
             width="110"
             height="14"
             name="clippy"
             quality="high"
             allowScriptAccess="always"
             type="application/x-shockwave-flash"
             pluginspage="http://www.macromedia.com/go/getflashplayer"
             FlashVars="text=git://github.com/bard/mozrepl.git"
             bgcolor="#F0F0F0"
             wmode="opaque"
      />
      </object>

                <div id="git-clone" style="display:none;">
                  Give this clone URL to anyone.
                  <br/>
                  <code>git clone git://github.com/bard/mozrepl.git </code>
                </div>
              </td>
            </tr>
          
          
          

          

          
      </table>

          </div>
  </div>




</div>


  <div id="commit">
    <div class="group">
        
  <div class="envelope commit">
    <div class="human">
      
        <div class="message"><pre><a href="/bard/mozrepl/commit/fa5651cfd686827576f63b8641483f41c1f99a26">REPL: httpInspectInteractor was referring to non-existing setInteractor(), 
fixed.  (Thanks Irakli Gozalishvili)</a> </pre></div>
      

      <div class="actor">
        <div class="gravatar">
          
          <img alt="" height="30" src="http://www.gravatar.com/avatar/1d0c1d44787dc21c27115da575bda5ba?s=30&amp;d=http%3A%2F%2Fgithub.com%2Fimages%2Fgravatars%2Fgravatar-30.png" width="30" />
        </div>
        <div class="name"><a href="/bard">bard</a> <span>(author)</span></div>
          <div class="date">
            <abbr class="relatize" title="2009-02-14 11:01:08">Sat Feb 14 11:01:08 -0800 2009</abbr> 
          </div>
      </div>
  
      
  
    </div>
    <div class="machine">
      <span>c</span>ommit&nbsp;&nbsp;<a href="/bard/mozrepl/commit/fa5651cfd686827576f63b8641483f41c1f99a26" hotkey="c">fa5651cfd686827576f63b8641483f41c1f99a26</a><br />
      <span>t</span>ree&nbsp;&nbsp;&nbsp;&nbsp;<a href="/bard/mozrepl/tree/fa5651cfd686827576f63b8641483f41c1f99a26" hotkey="t">40eace687e206463b102de085305286e8689c537</a><br />
  
      
        <span>p</span>arent&nbsp;
        
        <a href="/bard/mozrepl/tree/b1bb88c9cebd428ed696943a9b5bb7e7d4eaaad9" hotkey="p">b1bb88c9cebd428ed696943a9b5bb7e7d4eaaad9</a>
      
  
    </div>
  </div>

    </div>
  </div>



  
    <div id="path">
      <b><a href="/bard/mozrepl/tree">mozrepl</a></b> / <a href="/bard/mozrepl/tree/master/chrome">chrome</a> / <a href="/bard/mozrepl/tree/master/chrome/content">content</a> / javascript.el       <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"
              width="110"
              height="14"
              id="clippy" >
      <param name="movie" value="/flash/clippy.swf"/>
      <param name="allowScriptAccess" value="always" />
      <param name="quality" value="high" />
      <param name="scale" value="noscale" />
      <param NAME="FlashVars" value="text=chrome/content/javascript.el">
      <param name="bgcolor" value="#FFFFFF">
      <param name="wmode" value="opaque">
      <embed src="/flash/clippy.swf"
             width="110"
             height="14"
             name="clippy"
             quality="high"
             allowScriptAccess="always"
             type="application/x-shockwave-flash"
             pluginspage="http://www.macromedia.com/go/getflashplayer"
             FlashVars="text=chrome/content/javascript.el"
             bgcolor="#FFFFFF"
             wmode="opaque"
      />
      </object>

    </div>

    <div id="files">
      <div class="file">
        <div class="meta">
          <div class="info">
            <span>100644</span>
            <span>708 lines (593 sloc)</span>
            <span>24.097 kb</span>
          </div>
          <div class="actions">
            
            <a href="/bard/mozrepl/raw/master/chrome/content/javascript.el" id="raw-url">raw</a>
            
              <a href="/bard/mozrepl/blame/master/chrome/content/javascript.el">blame</a>
            
            <a href="/bard/mozrepl/commits/master/chrome/content/javascript.el">history</a>
          </div>
        </div>
        
  <div class="data syntax">
    
      <table cellpadding="0" cellspacing="0">
        <tr>
          <td>
            
            <pre class="line_numbers">
<span id="LID1" rel="#L1">1</span>
<span id="LID2" rel="#L2">2</span>
<span id="LID3" rel="#L3">3</span>
<span id="LID4" rel="#L4">4</span>
<span id="LID5" rel="#L5">5</span>
<span id="LID6" rel="#L6">6</span>
<span id="LID7" rel="#L7">7</span>
<span id="LID8" rel="#L8">8</span>
<span id="LID9" rel="#L9">9</span>
<span id="LID10" rel="#L10">10</span>
<span id="LID11" rel="#L11">11</span>
<span id="LID12" rel="#L12">12</span>
<span id="LID13" rel="#L13">13</span>
<span id="LID14" rel="#L14">14</span>
<span id="LID15" rel="#L15">15</span>
<span id="LID16" rel="#L16">16</span>
<span id="LID17" rel="#L17">17</span>
<span id="LID18" rel="#L18">18</span>
<span id="LID19" rel="#L19">19</span>
<span id="LID20" rel="#L20">20</span>
<span id="LID21" rel="#L21">21</span>
<span id="LID22" rel="#L22">22</span>
<span id="LID23" rel="#L23">23</span>
<span id="LID24" rel="#L24">24</span>
<span id="LID25" rel="#L25">25</span>
<span id="LID26" rel="#L26">26</span>
<span id="LID27" rel="#L27">27</span>
<span id="LID28" rel="#L28">28</span>
<span id="LID29" rel="#L29">29</span>
<span id="LID30" rel="#L30">30</span>
<span id="LID31" rel="#L31">31</span>
<span id="LID32" rel="#L32">32</span>
<span id="LID33" rel="#L33">33</span>
<span id="LID34" rel="#L34">34</span>
<span id="LID35" rel="#L35">35</span>
<span id="LID36" rel="#L36">36</span>
<span id="LID37" rel="#L37">37</span>
<span id="LID38" rel="#L38">38</span>
<span id="LID39" rel="#L39">39</span>
<span id="LID40" rel="#L40">40</span>
<span id="LID41" rel="#L41">41</span>
<span id="LID42" rel="#L42">42</span>
<span id="LID43" rel="#L43">43</span>
<span id="LID44" rel="#L44">44</span>
<span id="LID45" rel="#L45">45</span>
<span id="LID46" rel="#L46">46</span>
<span id="LID47" rel="#L47">47</span>
<span id="LID48" rel="#L48">48</span>
<span id="LID49" rel="#L49">49</span>
<span id="LID50" rel="#L50">50</span>
<span id="LID51" rel="#L51">51</span>
<span id="LID52" rel="#L52">52</span>
<span id="LID53" rel="#L53">53</span>
<span id="LID54" rel="#L54">54</span>
<span id="LID55" rel="#L55">55</span>
<span id="LID56" rel="#L56">56</span>
<span id="LID57" rel="#L57">57</span>
<span id="LID58" rel="#L58">58</span>
<span id="LID59" rel="#L59">59</span>
<span id="LID60" rel="#L60">60</span>
<span id="LID61" rel="#L61">61</span>
<span id="LID62" rel="#L62">62</span>
<span id="LID63" rel="#L63">63</span>
<span id="LID64" rel="#L64">64</span>
<span id="LID65" rel="#L65">65</span>
<span id="LID66" rel="#L66">66</span>
<span id="LID67" rel="#L67">67</span>
<span id="LID68" rel="#L68">68</span>
<span id="LID69" rel="#L69">69</span>
<span id="LID70" rel="#L70">70</span>
<span id="LID71" rel="#L71">71</span>
<span id="LID72" rel="#L72">72</span>
<span id="LID73" rel="#L73">73</span>
<span id="LID74" rel="#L74">74</span>
<span id="LID75" rel="#L75">75</span>
<span id="LID76" rel="#L76">76</span>
<span id="LID77" rel="#L77">77</span>
<span id="LID78" rel="#L78">78</span>
<span id="LID79" rel="#L79">79</span>
<span id="LID80" rel="#L80">80</span>
<span id="LID81" rel="#L81">81</span>
<span id="LID82" rel="#L82">82</span>
<span id="LID83" rel="#L83">83</span>
<span id="LID84" rel="#L84">84</span>
<span id="LID85" rel="#L85">85</span>
<span id="LID86" rel="#L86">86</span>
<span id="LID87" rel="#L87">87</span>
<span id="LID88" rel="#L88">88</span>
<span id="LID89" rel="#L89">89</span>
<span id="LID90" rel="#L90">90</span>
<span id="LID91" rel="#L91">91</span>
<span id="LID92" rel="#L92">92</span>
<span id="LID93" rel="#L93">93</span>
<span id="LID94" rel="#L94">94</span>
<span id="LID95" rel="#L95">95</span>
<span id="LID96" rel="#L96">96</span>
<span id="LID97" rel="#L97">97</span>
<span id="LID98" rel="#L98">98</span>
<span id="LID99" rel="#L99">99</span>
<span id="LID100" rel="#L100">100</span>
<span id="LID101" rel="#L101">101</span>
<span id="LID102" rel="#L102">102</span>
<span id="LID103" rel="#L103">103</span>
<span id="LID104" rel="#L104">104</span>
<span id="LID105" rel="#L105">105</span>
<span id="LID106" rel="#L106">106</span>
<span id="LID107" rel="#L107">107</span>
<span id="LID108" rel="#L108">108</span>
<span id="LID109" rel="#L109">109</span>
<span id="LID110" rel="#L110">110</span>
<span id="LID111" rel="#L111">111</span>
<span id="LID112" rel="#L112">112</span>
<span id="LID113" rel="#L113">113</span>
<span id="LID114" rel="#L114">114</span>
<span id="LID115" rel="#L115">115</span>
<span id="LID116" rel="#L116">116</span>
<span id="LID117" rel="#L117">117</span>
<span id="LID118" rel="#L118">118</span>
<span id="LID119" rel="#L119">119</span>
<span id="LID120" rel="#L120">120</span>
<span id="LID121" rel="#L121">121</span>
<span id="LID122" rel="#L122">122</span>
<span id="LID123" rel="#L123">123</span>
<span id="LID124" rel="#L124">124</span>
<span id="LID125" rel="#L125">125</span>
<span id="LID126" rel="#L126">126</span>
<span id="LID127" rel="#L127">127</span>
<span id="LID128" rel="#L128">128</span>
<span id="LID129" rel="#L129">129</span>
<span id="LID130" rel="#L130">130</span>
<span id="LID131" rel="#L131">131</span>
<span id="LID132" rel="#L132">132</span>
<span id="LID133" rel="#L133">133</span>
<span id="LID134" rel="#L134">134</span>
<span id="LID135" rel="#L135">135</span>
<span id="LID136" rel="#L136">136</span>
<span id="LID137" rel="#L137">137</span>
<span id="LID138" rel="#L138">138</span>
<span id="LID139" rel="#L139">139</span>
<span id="LID140" rel="#L140">140</span>
<span id="LID141" rel="#L141">141</span>
<span id="LID142" rel="#L142">142</span>
<span id="LID143" rel="#L143">143</span>
<span id="LID144" rel="#L144">144</span>
<span id="LID145" rel="#L145">145</span>
<span id="LID146" rel="#L146">146</span>
<span id="LID147" rel="#L147">147</span>
<span id="LID148" rel="#L148">148</span>
<span id="LID149" rel="#L149">149</span>
<span id="LID150" rel="#L150">150</span>
<span id="LID151" rel="#L151">151</span>
<span id="LID152" rel="#L152">152</span>
<span id="LID153" rel="#L153">153</span>
<span id="LID154" rel="#L154">154</span>
<span id="LID155" rel="#L155">155</span>
<span id="LID156" rel="#L156">156</span>
<span id="LID157" rel="#L157">157</span>
<span id="LID158" rel="#L158">158</span>
<span id="LID159" rel="#L159">159</span>
<span id="LID160" rel="#L160">160</span>
<span id="LID161" rel="#L161">161</span>
<span id="LID162" rel="#L162">162</span>
<span id="LID163" rel="#L163">163</span>
<span id="LID164" rel="#L164">164</span>
<span id="LID165" rel="#L165">165</span>
<span id="LID166" rel="#L166">166</span>
<span id="LID167" rel="#L167">167</span>
<span id="LID168" rel="#L168">168</span>
<span id="LID169" rel="#L169">169</span>
<span id="LID170" rel="#L170">170</span>
<span id="LID171" rel="#L171">171</span>
<span id="LID172" rel="#L172">172</span>
<span id="LID173" rel="#L173">173</span>
<span id="LID174" rel="#L174">174</span>
<span id="LID175" rel="#L175">175</span>
<span id="LID176" rel="#L176">176</span>
<span id="LID177" rel="#L177">177</span>
<span id="LID178" rel="#L178">178</span>
<span id="LID179" rel="#L179">179</span>
<span id="LID180" rel="#L180">180</span>
<span id="LID181" rel="#L181">181</span>
<span id="LID182" rel="#L182">182</span>
<span id="LID183" rel="#L183">183</span>
<span id="LID184" rel="#L184">184</span>
<span id="LID185" rel="#L185">185</span>
<span id="LID186" rel="#L186">186</span>
<span id="LID187" rel="#L187">187</span>
<span id="LID188" rel="#L188">188</span>
<span id="LID189" rel="#L189">189</span>
<span id="LID190" rel="#L190">190</span>
<span id="LID191" rel="#L191">191</span>
<span id="LID192" rel="#L192">192</span>
<span id="LID193" rel="#L193">193</span>
<span id="LID194" rel="#L194">194</span>
<span id="LID195" rel="#L195">195</span>
<span id="LID196" rel="#L196">196</span>
<span id="LID197" rel="#L197">197</span>
<span id="LID198" rel="#L198">198</span>
<span id="LID199" rel="#L199">199</span>
<span id="LID200" rel="#L200">200</span>
<span id="LID201" rel="#L201">201</span>
<span id="LID202" rel="#L202">202</span>
<span id="LID203" rel="#L203">203</span>
<span id="LID204" rel="#L204">204</span>
<span id="LID205" rel="#L205">205</span>
<span id="LID206" rel="#L206">206</span>
<span id="LID207" rel="#L207">207</span>
<span id="LID208" rel="#L208">208</span>
<span id="LID209" rel="#L209">209</span>
<span id="LID210" rel="#L210">210</span>
<span id="LID211" rel="#L211">211</span>
<span id="LID212" rel="#L212">212</span>
<span id="LID213" rel="#L213">213</span>
<span id="LID214" rel="#L214">214</span>
<span id="LID215" rel="#L215">215</span>
<span id="LID216" rel="#L216">216</span>
<span id="LID217" rel="#L217">217</span>
<span id="LID218" rel="#L218">218</span>
<span id="LID219" rel="#L219">219</span>
<span id="LID220" rel="#L220">220</span>
<span id="LID221" rel="#L221">221</span>
<span id="LID222" rel="#L222">222</span>
<span id="LID223" rel="#L223">223</span>
<span id="LID224" rel="#L224">224</span>
<span id="LID225" rel="#L225">225</span>
<span id="LID226" rel="#L226">226</span>
<span id="LID227" rel="#L227">227</span>
<span id="LID228" rel="#L228">228</span>
<span id="LID229" rel="#L229">229</span>
<span id="LID230" rel="#L230">230</span>
<span id="LID231" rel="#L231">231</span>
<span id="LID232" rel="#L232">232</span>
<span id="LID233" rel="#L233">233</span>
<span id="LID234" rel="#L234">234</span>
<span id="LID235" rel="#L235">235</span>
<span id="LID236" rel="#L236">236</span>
<span id="LID237" rel="#L237">237</span>
<span id="LID238" rel="#L238">238</span>
<span id="LID239" rel="#L239">239</span>
<span id="LID240" rel="#L240">240</span>
<span id="LID241" rel="#L241">241</span>
<span id="LID242" rel="#L242">242</span>
<span id="LID243" rel="#L243">243</span>
<span id="LID244" rel="#L244">244</span>
<span id="LID245" rel="#L245">245</span>
<span id="LID246" rel="#L246">246</span>
<span id="LID247" rel="#L247">247</span>
<span id="LID248" rel="#L248">248</span>
<span id="LID249" rel="#L249">249</span>
<span id="LID250" rel="#L250">250</span>
<span id="LID251" rel="#L251">251</span>
<span id="LID252" rel="#L252">252</span>
<span id="LID253" rel="#L253">253</span>
<span id="LID254" rel="#L254">254</span>
<span id="LID255" rel="#L255">255</span>
<span id="LID256" rel="#L256">256</span>
<span id="LID257" rel="#L257">257</span>
<span id="LID258" rel="#L258">258</span>
<span id="LID259" rel="#L259">259</span>
<span id="LID260" rel="#L260">260</span>
<span id="LID261" rel="#L261">261</span>
<span id="LID262" rel="#L262">262</span>
<span id="LID263" rel="#L263">263</span>
<span id="LID264" rel="#L264">264</span>
<span id="LID265" rel="#L265">265</span>
<span id="LID266" rel="#L266">266</span>
<span id="LID267" rel="#L267">267</span>
<span id="LID268" rel="#L268">268</span>
<span id="LID269" rel="#L269">269</span>
<span id="LID270" rel="#L270">270</span>
<span id="LID271" rel="#L271">271</span>
<span id="LID272" rel="#L272">272</span>
<span id="LID273" rel="#L273">273</span>
<span id="LID274" rel="#L274">274</span>
<span id="LID275" rel="#L275">275</span>
<span id="LID276" rel="#L276">276</span>
<span id="LID277" rel="#L277">277</span>
<span id="LID278" rel="#L278">278</span>
<span id="LID279" rel="#L279">279</span>
<span id="LID280" rel="#L280">280</span>
<span id="LID281" rel="#L281">281</span>
<span id="LID282" rel="#L282">282</span>
<span id="LID283" rel="#L283">283</span>
<span id="LID284" rel="#L284">284</span>
<span id="LID285" rel="#L285">285</span>
<span id="LID286" rel="#L286">286</span>
<span id="LID287" rel="#L287">287</span>
<span id="LID288" rel="#L288">288</span>
<span id="LID289" rel="#L289">289</span>
<span id="LID290" rel="#L290">290</span>
<span id="LID291" rel="#L291">291</span>
<span id="LID292" rel="#L292">292</span>
<span id="LID293" rel="#L293">293</span>
<span id="LID294" rel="#L294">294</span>
<span id="LID295" rel="#L295">295</span>
<span id="LID296" rel="#L296">296</span>
<span id="LID297" rel="#L297">297</span>
<span id="LID298" rel="#L298">298</span>
<span id="LID299" rel="#L299">299</span>
<span id="LID300" rel="#L300">300</span>
<span id="LID301" rel="#L301">301</span>
<span id="LID302" rel="#L302">302</span>
<span id="LID303" rel="#L303">303</span>
<span id="LID304" rel="#L304">304</span>
<span id="LID305" rel="#L305">305</span>
<span id="LID306" rel="#L306">306</span>
<span id="LID307" rel="#L307">307</span>
<span id="LID308" rel="#L308">308</span>
<span id="LID309" rel="#L309">309</span>
<span id="LID310" rel="#L310">310</span>
<span id="LID311" rel="#L311">311</span>
<span id="LID312" rel="#L312">312</span>
<span id="LID313" rel="#L313">313</span>
<span id="LID314" rel="#L314">314</span>
<span id="LID315" rel="#L315">315</span>
<span id="LID316" rel="#L316">316</span>
<span id="LID317" rel="#L317">317</span>
<span id="LID318" rel="#L318">318</span>
<span id="LID319" rel="#L319">319</span>
<span id="LID320" rel="#L320">320</span>
<span id="LID321" rel="#L321">321</span>
<span id="LID322" rel="#L322">322</span>
<span id="LID323" rel="#L323">323</span>
<span id="LID324" rel="#L324">324</span>
<span id="LID325" rel="#L325">325</span>
<span id="LID326" rel="#L326">326</span>
<span id="LID327" rel="#L327">327</span>
<span id="LID328" rel="#L328">328</span>
<span id="LID329" rel="#L329">329</span>
<span id="LID330" rel="#L330">330</span>
<span id="LID331" rel="#L331">331</span>
<span id="LID332" rel="#L332">332</span>
<span id="LID333" rel="#L333">333</span>
<span id="LID334" rel="#L334">334</span>
<span id="LID335" rel="#L335">335</span>
<span id="LID336" rel="#L336">336</span>
<span id="LID337" rel="#L337">337</span>
<span id="LID338" rel="#L338">338</span>
<span id="LID339" rel="#L339">339</span>
<span id="LID340" rel="#L340">340</span>
<span id="LID341" rel="#L341">341</span>
<span id="LID342" rel="#L342">342</span>
<span id="LID343" rel="#L343">343</span>
<span id="LID344" rel="#L344">344</span>
<span id="LID345" rel="#L345">345</span>
<span id="LID346" rel="#L346">346</span>
<span id="LID347" rel="#L347">347</span>
<span id="LID348" rel="#L348">348</span>
<span id="LID349" rel="#L349">349</span>
<span id="LID350" rel="#L350">350</span>
<span id="LID351" rel="#L351">351</span>
<span id="LID352" rel="#L352">352</span>
<span id="LID353" rel="#L353">353</span>
<span id="LID354" rel="#L354">354</span>
<span id="LID355" rel="#L355">355</span>
<span id="LID356" rel="#L356">356</span>
<span id="LID357" rel="#L357">357</span>
<span id="LID358" rel="#L358">358</span>
<span id="LID359" rel="#L359">359</span>
<span id="LID360" rel="#L360">360</span>
<span id="LID361" rel="#L361">361</span>
<span id="LID362" rel="#L362">362</span>
<span id="LID363" rel="#L363">363</span>
<span id="LID364" rel="#L364">364</span>
<span id="LID365" rel="#L365">365</span>
<span id="LID366" rel="#L366">366</span>
<span id="LID367" rel="#L367">367</span>
<span id="LID368" rel="#L368">368</span>
<span id="LID369" rel="#L369">369</span>
<span id="LID370" rel="#L370">370</span>
<span id="LID371" rel="#L371">371</span>
<span id="LID372" rel="#L372">372</span>
<span id="LID373" rel="#L373">373</span>
<span id="LID374" rel="#L374">374</span>
<span id="LID375" rel="#L375">375</span>
<span id="LID376" rel="#L376">376</span>
<span id="LID377" rel="#L377">377</span>
<span id="LID378" rel="#L378">378</span>
<span id="LID379" rel="#L379">379</span>
<span id="LID380" rel="#L380">380</span>
<span id="LID381" rel="#L381">381</span>
<span id="LID382" rel="#L382">382</span>
<span id="LID383" rel="#L383">383</span>
<span id="LID384" rel="#L384">384</span>
<span id="LID385" rel="#L385">385</span>
<span id="LID386" rel="#L386">386</span>
<span id="LID387" rel="#L387">387</span>
<span id="LID388" rel="#L388">388</span>
<span id="LID389" rel="#L389">389</span>
<span id="LID390" rel="#L390">390</span>
<span id="LID391" rel="#L391">391</span>
<span id="LID392" rel="#L392">392</span>
<span id="LID393" rel="#L393">393</span>
<span id="LID394" rel="#L394">394</span>
<span id="LID395" rel="#L395">395</span>
<span id="LID396" rel="#L396">396</span>
<span id="LID397" rel="#L397">397</span>
<span id="LID398" rel="#L398">398</span>
<span id="LID399" rel="#L399">399</span>
<span id="LID400" rel="#L400">400</span>
<span id="LID401" rel="#L401">401</span>
<span id="LID402" rel="#L402">402</span>
<span id="LID403" rel="#L403">403</span>
<span id="LID404" rel="#L404">404</span>
<span id="LID405" rel="#L405">405</span>
<span id="LID406" rel="#L406">406</span>
<span id="LID407" rel="#L407">407</span>
<span id="LID408" rel="#L408">408</span>
<span id="LID409" rel="#L409">409</span>
<span id="LID410" rel="#L410">410</span>
<span id="LID411" rel="#L411">411</span>
<span id="LID412" rel="#L412">412</span>
<span id="LID413" rel="#L413">413</span>
<span id="LID414" rel="#L414">414</span>
<span id="LID415" rel="#L415">415</span>
<span id="LID416" rel="#L416">416</span>
<span id="LID417" rel="#L417">417</span>
<span id="LID418" rel="#L418">418</span>
<span id="LID419" rel="#L419">419</span>
<span id="LID420" rel="#L420">420</span>
<span id="LID421" rel="#L421">421</span>
<span id="LID422" rel="#L422">422</span>
<span id="LID423" rel="#L423">423</span>
<span id="LID424" rel="#L424">424</span>
<span id="LID425" rel="#L425">425</span>
<span id="LID426" rel="#L426">426</span>
<span id="LID427" rel="#L427">427</span>
<span id="LID428" rel="#L428">428</span>
<span id="LID429" rel="#L429">429</span>
<span id="LID430" rel="#L430">430</span>
<span id="LID431" rel="#L431">431</span>
<span id="LID432" rel="#L432">432</span>
<span id="LID433" rel="#L433">433</span>
<span id="LID434" rel="#L434">434</span>
<span id="LID435" rel="#L435">435</span>
<span id="LID436" rel="#L436">436</span>
<span id="LID437" rel="#L437">437</span>
<span id="LID438" rel="#L438">438</span>
<span id="LID439" rel="#L439">439</span>
<span id="LID440" rel="#L440">440</span>
<span id="LID441" rel="#L441">441</span>
<span id="LID442" rel="#L442">442</span>
<span id="LID443" rel="#L443">443</span>
<span id="LID444" rel="#L444">444</span>
<span id="LID445" rel="#L445">445</span>
<span id="LID446" rel="#L446">446</span>
<span id="LID447" rel="#L447">447</span>
<span id="LID448" rel="#L448">448</span>
<span id="LID449" rel="#L449">449</span>
<span id="LID450" rel="#L450">450</span>
<span id="LID451" rel="#L451">451</span>
<span id="LID452" rel="#L452">452</span>
<span id="LID453" rel="#L453">453</span>
<span id="LID454" rel="#L454">454</span>
<span id="LID455" rel="#L455">455</span>
<span id="LID456" rel="#L456">456</span>
<span id="LID457" rel="#L457">457</span>
<span id="LID458" rel="#L458">458</span>
<span id="LID459" rel="#L459">459</span>
<span id="LID460" rel="#L460">460</span>
<span id="LID461" rel="#L461">461</span>
<span id="LID462" rel="#L462">462</span>
<span id="LID463" rel="#L463">463</span>
<span id="LID464" rel="#L464">464</span>
<span id="LID465" rel="#L465">465</span>
<span id="LID466" rel="#L466">466</span>
<span id="LID467" rel="#L467">467</span>
<span id="LID468" rel="#L468">468</span>
<span id="LID469" rel="#L469">469</span>
<span id="LID470" rel="#L470">470</span>
<span id="LID471" rel="#L471">471</span>
<span id="LID472" rel="#L472">472</span>
<span id="LID473" rel="#L473">473</span>
<span id="LID474" rel="#L474">474</span>
<span id="LID475" rel="#L475">475</span>
<span id="LID476" rel="#L476">476</span>
<span id="LID477" rel="#L477">477</span>
<span id="LID478" rel="#L478">478</span>
<span id="LID479" rel="#L479">479</span>
<span id="LID480" rel="#L480">480</span>
<span id="LID481" rel="#L481">481</span>
<span id="LID482" rel="#L482">482</span>
<span id="LID483" rel="#L483">483</span>
<span id="LID484" rel="#L484">484</span>
<span id="LID485" rel="#L485">485</span>
<span id="LID486" rel="#L486">486</span>
<span id="LID487" rel="#L487">487</span>
<span id="LID488" rel="#L488">488</span>
<span id="LID489" rel="#L489">489</span>
<span id="LID490" rel="#L490">490</span>
<span id="LID491" rel="#L491">491</span>
<span id="LID492" rel="#L492">492</span>
<span id="LID493" rel="#L493">493</span>
<span id="LID494" rel="#L494">494</span>
<span id="LID495" rel="#L495">495</span>
<span id="LID496" rel="#L496">496</span>
<span id="LID497" rel="#L497">497</span>
<span id="LID498" rel="#L498">498</span>
<span id="LID499" rel="#L499">499</span>
<span id="LID500" rel="#L500">500</span>
<span id="LID501" rel="#L501">501</span>
<span id="LID502" rel="#L502">502</span>
<span id="LID503" rel="#L503">503</span>
<span id="LID504" rel="#L504">504</span>
<span id="LID505" rel="#L505">505</span>
<span id="LID506" rel="#L506">506</span>
<span id="LID507" rel="#L507">507</span>
<span id="LID508" rel="#L508">508</span>
<span id="LID509" rel="#L509">509</span>
<span id="LID510" rel="#L510">510</span>
<span id="LID511" rel="#L511">511</span>
<span id="LID512" rel="#L512">512</span>
<span id="LID513" rel="#L513">513</span>
<span id="LID514" rel="#L514">514</span>
<span id="LID515" rel="#L515">515</span>
<span id="LID516" rel="#L516">516</span>
<span id="LID517" rel="#L517">517</span>
<span id="LID518" rel="#L518">518</span>
<span id="LID519" rel="#L519">519</span>
<span id="LID520" rel="#L520">520</span>
<span id="LID521" rel="#L521">521</span>
<span id="LID522" rel="#L522">522</span>
<span id="LID523" rel="#L523">523</span>
<span id="LID524" rel="#L524">524</span>
<span id="LID525" rel="#L525">525</span>
<span id="LID526" rel="#L526">526</span>
<span id="LID527" rel="#L527">527</span>
<span id="LID528" rel="#L528">528</span>
<span id="LID529" rel="#L529">529</span>
<span id="LID530" rel="#L530">530</span>
<span id="LID531" rel="#L531">531</span>
<span id="LID532" rel="#L532">532</span>
<span id="LID533" rel="#L533">533</span>
<span id="LID534" rel="#L534">534</span>
<span id="LID535" rel="#L535">535</span>
<span id="LID536" rel="#L536">536</span>
<span id="LID537" rel="#L537">537</span>
<span id="LID538" rel="#L538">538</span>
<span id="LID539" rel="#L539">539</span>
<span id="LID540" rel="#L540">540</span>
<span id="LID541" rel="#L541">541</span>
<span id="LID542" rel="#L542">542</span>
<span id="LID543" rel="#L543">543</span>
<span id="LID544" rel="#L544">544</span>
<span id="LID545" rel="#L545">545</span>
<span id="LID546" rel="#L546">546</span>
<span id="LID547" rel="#L547">547</span>
<span id="LID548" rel="#L548">548</span>
<span id="LID549" rel="#L549">549</span>
<span id="LID550" rel="#L550">550</span>
<span id="LID551" rel="#L551">551</span>
<span id="LID552" rel="#L552">552</span>
<span id="LID553" rel="#L553">553</span>
<span id="LID554" rel="#L554">554</span>
<span id="LID555" rel="#L555">555</span>
<span id="LID556" rel="#L556">556</span>
<span id="LID557" rel="#L557">557</span>
<span id="LID558" rel="#L558">558</span>
<span id="LID559" rel="#L559">559</span>
<span id="LID560" rel="#L560">560</span>
<span id="LID561" rel="#L561">561</span>
<span id="LID562" rel="#L562">562</span>
<span id="LID563" rel="#L563">563</span>
<span id="LID564" rel="#L564">564</span>
<span id="LID565" rel="#L565">565</span>
<span id="LID566" rel="#L566">566</span>
<span id="LID567" rel="#L567">567</span>
<span id="LID568" rel="#L568">568</span>
<span id="LID569" rel="#L569">569</span>
<span id="LID570" rel="#L570">570</span>
<span id="LID571" rel="#L571">571</span>
<span id="LID572" rel="#L572">572</span>
<span id="LID573" rel="#L573">573</span>
<span id="LID574" rel="#L574">574</span>
<span id="LID575" rel="#L575">575</span>
<span id="LID576" rel="#L576">576</span>
<span id="LID577" rel="#L577">577</span>
<span id="LID578" rel="#L578">578</span>
<span id="LID579" rel="#L579">579</span>
<span id="LID580" rel="#L580">580</span>
<span id="LID581" rel="#L581">581</span>
<span id="LID582" rel="#L582">582</span>
<span id="LID583" rel="#L583">583</span>
<span id="LID584" rel="#L584">584</span>
<span id="LID585" rel="#L585">585</span>
<span id="LID586" rel="#L586">586</span>
<span id="LID587" rel="#L587">587</span>
<span id="LID588" rel="#L588">588</span>
<span id="LID589" rel="#L589">589</span>
<span id="LID590" rel="#L590">590</span>
<span id="LID591" rel="#L591">591</span>
<span id="LID592" rel="#L592">592</span>
<span id="LID593" rel="#L593">593</span>
<span id="LID594" rel="#L594">594</span>
<span id="LID595" rel="#L595">595</span>
<span id="LID596" rel="#L596">596</span>
<span id="LID597" rel="#L597">597</span>
<span id="LID598" rel="#L598">598</span>
<span id="LID599" rel="#L599">599</span>
<span id="LID600" rel="#L600">600</span>
<span id="LID601" rel="#L601">601</span>
<span id="LID602" rel="#L602">602</span>
<span id="LID603" rel="#L603">603</span>
<span id="LID604" rel="#L604">604</span>
<span id="LID605" rel="#L605">605</span>
<span id="LID606" rel="#L606">606</span>
<span id="LID607" rel="#L607">607</span>
<span id="LID608" rel="#L608">608</span>
<span id="LID609" rel="#L609">609</span>
<span id="LID610" rel="#L610">610</span>
<span id="LID611" rel="#L611">611</span>
<span id="LID612" rel="#L612">612</span>
<span id="LID613" rel="#L613">613</span>
<span id="LID614" rel="#L614">614</span>
<span id="LID615" rel="#L615">615</span>
<span id="LID616" rel="#L616">616</span>
<span id="LID617" rel="#L617">617</span>
<span id="LID618" rel="#L618">618</span>
<span id="LID619" rel="#L619">619</span>
<span id="LID620" rel="#L620">620</span>
<span id="LID621" rel="#L621">621</span>
<span id="LID622" rel="#L622">622</span>
<span id="LID623" rel="#L623">623</span>
<span id="LID624" rel="#L624">624</span>
<span id="LID625" rel="#L625">625</span>
<span id="LID626" rel="#L626">626</span>
<span id="LID627" rel="#L627">627</span>
<span id="LID628" rel="#L628">628</span>
<span id="LID629" rel="#L629">629</span>
<span id="LID630" rel="#L630">630</span>
<span id="LID631" rel="#L631">631</span>
<span id="LID632" rel="#L632">632</span>
<span id="LID633" rel="#L633">633</span>
<span id="LID634" rel="#L634">634</span>
<span id="LID635" rel="#L635">635</span>
<span id="LID636" rel="#L636">636</span>
<span id="LID637" rel="#L637">637</span>
<span id="LID638" rel="#L638">638</span>
<span id="LID639" rel="#L639">639</span>
<span id="LID640" rel="#L640">640</span>
<span id="LID641" rel="#L641">641</span>
<span id="LID642" rel="#L642">642</span>
<span id="LID643" rel="#L643">643</span>
<span id="LID644" rel="#L644">644</span>
<span id="LID645" rel="#L645">645</span>
<span id="LID646" rel="#L646">646</span>
<span id="LID647" rel="#L647">647</span>
<span id="LID648" rel="#L648">648</span>
<span id="LID649" rel="#L649">649</span>
<span id="LID650" rel="#L650">650</span>
<span id="LID651" rel="#L651">651</span>
<span id="LID652" rel="#L652">652</span>
<span id="LID653" rel="#L653">653</span>
<span id="LID654" rel="#L654">654</span>
<span id="LID655" rel="#L655">655</span>
<span id="LID656" rel="#L656">656</span>
<span id="LID657" rel="#L657">657</span>
<span id="LID658" rel="#L658">658</span>
<span id="LID659" rel="#L659">659</span>
<span id="LID660" rel="#L660">660</span>
<span id="LID661" rel="#L661">661</span>
<span id="LID662" rel="#L662">662</span>
<span id="LID663" rel="#L663">663</span>
<span id="LID664" rel="#L664">664</span>
<span id="LID665" rel="#L665">665</span>
<span id="LID666" rel="#L666">666</span>
<span id="LID667" rel="#L667">667</span>
<span id="LID668" rel="#L668">668</span>
<span id="LID669" rel="#L669">669</span>
<span id="LID670" rel="#L670">670</span>
<span id="LID671" rel="#L671">671</span>
<span id="LID672" rel="#L672">672</span>
<span id="LID673" rel="#L673">673</span>
<span id="LID674" rel="#L674">674</span>
<span id="LID675" rel="#L675">675</span>
<span id="LID676" rel="#L676">676</span>
<span id="LID677" rel="#L677">677</span>
<span id="LID678" rel="#L678">678</span>
<span id="LID679" rel="#L679">679</span>
<span id="LID680" rel="#L680">680</span>
<span id="LID681" rel="#L681">681</span>
<span id="LID682" rel="#L682">682</span>
<span id="LID683" rel="#L683">683</span>
<span id="LID684" rel="#L684">684</span>
<span id="LID685" rel="#L685">685</span>
<span id="LID686" rel="#L686">686</span>
<span id="LID687" rel="#L687">687</span>
<span id="LID688" rel="#L688">688</span>
<span id="LID689" rel="#L689">689</span>
<span id="LID690" rel="#L690">690</span>
<span id="LID691" rel="#L691">691</span>
<span id="LID692" rel="#L692">692</span>
<span id="LID693" rel="#L693">693</span>
<span id="LID694" rel="#L694">694</span>
<span id="LID695" rel="#L695">695</span>
<span id="LID696" rel="#L696">696</span>
<span id="LID697" rel="#L697">697</span>
<span id="LID698" rel="#L698">698</span>
<span id="LID699" rel="#L699">699</span>
<span id="LID700" rel="#L700">700</span>
<span id="LID701" rel="#L701">701</span>
<span id="LID702" rel="#L702">702</span>
<span id="LID703" rel="#L703">703</span>
<span id="LID704" rel="#L704">704</span>
<span id="LID705" rel="#L705">705</span>
<span id="LID706" rel="#L706">706</span>
<span id="LID707" rel="#L707">707</span>
<span id="LID708" rel="#L708">708</span>
</pre>
          </td>
          <td width="100%">
            
            
              <div class="highlight"><pre><div class="line" id="LC1"><span class="c1">;;; javascript.el --- Major mode for editing JavaScript source text</span></div><div class="line" id="LC2">&nbsp;</div><div class="line" id="LC3"><span class="c1">;; Copyright (C) 2006 Karl Landström</span></div><div class="line" id="LC4">&nbsp;</div><div class="line" id="LC5"><span class="c1">;; Author: Karl Landström &lt;kland@comhem.se&gt;</span></div><div class="line" id="LC6"><span class="c1">;; Maintainer: Karl Landström &lt;kland@comhem.se&gt;</span></div><div class="line" id="LC7"><span class="c1">;; Version: 2.0 Beta 8</span></div><div class="line" id="LC8"><span class="c1">;; Date: 2006-12-26</span></div><div class="line" id="LC9"><span class="c1">;; Keywords: languages, oop</span></div><div class="line" id="LC10">&nbsp;</div><div class="line" id="LC11"><span class="c1">;; This file is free software; you can redistribute it and/or modify</span></div><div class="line" id="LC12"><span class="c1">;; it under the terms of the GNU General Public License as published by</span></div><div class="line" id="LC13"><span class="c1">;; the Free Software Foundation; either version 2, or (at your option)</span></div><div class="line" id="LC14"><span class="c1">;; any later version.</span></div><div class="line" id="LC15">&nbsp;</div><div class="line" id="LC16"><span class="c1">;; This file is distributed in the hope that it will be useful,</span></div><div class="line" id="LC17"><span class="c1">;; but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line" id="LC18"><span class="c1">;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line" id="LC19"><span class="c1">;; GNU General Public License for more details.</span></div><div class="line" id="LC20">&nbsp;</div><div class="line" id="LC21"><span class="c1">;; You should have received a copy of the GNU General Public License</span></div><div class="line" id="LC22"><span class="c1">;; along with GNU Emacs; see the file COPYING.  If not, write to</span></div><div class="line" id="LC23"><span class="c1">;; the Free Software Foundation, Inc., 59 Temple Place - Suite 330,</span></div><div class="line" id="LC24"><span class="c1">;; Boston, MA 02111-1307, USA.</span></div><div class="line" id="LC25">&nbsp;</div><div class="line" id="LC26"><span class="c1">;;; Commentary:</span></div><div class="line" id="LC27"><span class="c1">;;</span></div><div class="line" id="LC28"><span class="c1">;; The main features of this JavaScript mode are syntactic</span></div><div class="line" id="LC29"><span class="c1">;; highlighting (enabled with `font-lock-mode&#39; or</span></div><div class="line" id="LC30"><span class="c1">;; `global-font-lock-mode&#39;), automatic indentation and filling of</span></div><div class="line" id="LC31"><span class="c1">;; comments.</span></div><div class="line" id="LC32"><span class="c1">;;</span></div><div class="line" id="LC33"><span class="c1">;; This package has (only) been tested with GNU Emacs 21.4 (the latest</span></div><div class="line" id="LC34"><span class="c1">;; stable release).</span></div><div class="line" id="LC35"><span class="c1">;;</span></div><div class="line" id="LC36"><span class="c1">;; Installation:</span></div><div class="line" id="LC37"><span class="c1">;;</span></div><div class="line" id="LC38"><span class="c1">;; Put this file in a directory where Emacs can find it (`C-h v</span></div><div class="line" id="LC39"><span class="c1">;; load-path&#39; for more info). Then add the following lines to your</span></div><div class="line" id="LC40"><span class="c1">;; Emacs initialization file:</span></div><div class="line" id="LC41"><span class="c1">;; </span></div><div class="line" id="LC42"><span class="c1">;;    (add-to-list &#39;auto-mode-alist &#39;(&quot;\\.js\\&#39;&quot; . javascript-mode))</span></div><div class="line" id="LC43"><span class="c1">;;    (autoload &#39;javascript-mode &quot;javascript&quot; nil t)</span></div><div class="line" id="LC44"><span class="c1">;;    </span></div><div class="line" id="LC45"><span class="c1">;; General Remarks:</span></div><div class="line" id="LC46"><span class="c1">;; </span></div><div class="line" id="LC47"><span class="c1">;; This mode assumes that block comments are not nested inside block</span></div><div class="line" id="LC48"><span class="c1">;; comments and that strings do not contain line breaks.</span></div><div class="line" id="LC49"><span class="c1">;; </span></div><div class="line" id="LC50"><span class="c1">;; Exported names start with &quot;javascript-&quot; whereas private names start</span></div><div class="line" id="LC51"><span class="c1">;; with &quot;js-&quot;.</span></div><div class="line" id="LC52"><span class="c1">;; </span></div><div class="line" id="LC53"><span class="c1">;; Changes:</span></div><div class="line" id="LC54"><span class="c1">;;</span></div><div class="line" id="LC55"><span class="c1">;; See javascript.el.changelog.</span></div><div class="line" id="LC56">&nbsp;</div><div class="line" id="LC57"><span class="c1">;;; Code:</span></div><div class="line" id="LC58">&nbsp;</div><div class="line" id="LC59"><span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;cc-mode</span><span class="p">)</span></div><div class="line" id="LC60"><span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;font-lock</span><span class="p">)</span></div><div class="line" id="LC61"><span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;newcomment</span><span class="p">)</span></div><div class="line" id="LC62">&nbsp;</div><div class="line" id="LC63"><span class="p">(</span><span class="nf">defgroup</span> <span class="nv">javascript</span> <span class="nv">nil</span> </div><div class="line" id="LC64">&nbsp;&nbsp;<span class="s">&quot;Customization variables for `javascript-mode&#39;.&quot;</span></div><div class="line" id="LC65">&nbsp;&nbsp;<span class="nv">:tag</span> <span class="s">&quot;JavaScript&quot;</span></div><div class="line" id="LC66">&nbsp;&nbsp;<span class="nv">:group</span> <span class="ss">&#39;languages</span><span class="p">)</span></div><div class="line" id="LC67">&nbsp;</div><div class="line" id="LC68"><span class="p">(</span><span class="nf">defcustom</span> <span class="nv">javascript-indent-level</span> <span class="mi">4</span></div><div class="line" id="LC69">&nbsp;&nbsp;<span class="s">&quot;Number of spaces for each indentation step.&quot;</span></div><div class="line" id="LC70">&nbsp;&nbsp;<span class="nv">:type</span> <span class="ss">&#39;integer</span></div><div class="line" id="LC71">&nbsp;&nbsp;<span class="nv">:group</span> <span class="ss">&#39;javascript</span><span class="p">)</span></div><div class="line" id="LC72">&nbsp;</div><div class="line" id="LC73"><span class="p">(</span><span class="nf">defcustom</span> <span class="nv">javascript-auto-indent-flag</span> <span class="nv">t</span></div><div class="line" id="LC74">&nbsp;&nbsp;<span class="s">&quot;Automatic indentation with punctuation characters. If non-nil, the</span></div><div class="line" id="LC75"><span class="s">current line is indented when certain punctuations are inserted.&quot;</span></div><div class="line" id="LC76">&nbsp;&nbsp;<span class="nv">:type</span> <span class="ss">&#39;boolean</span></div><div class="line" id="LC77">&nbsp;&nbsp;<span class="nv">:group</span> <span class="ss">&#39;javascript</span><span class="p">)</span></div><div class="line" id="LC78">&nbsp;</div><div class="line" id="LC79">&nbsp;</div><div class="line" id="LC80"><span class="c1">;; --- Keymap ---</span></div><div class="line" id="LC81">&nbsp;</div><div class="line" id="LC82"><span class="p">(</span><span class="nf">defvar</span> <span class="nv">javascript-mode-map</span> <span class="nv">nil</span> </div><div class="line" id="LC83">&nbsp;&nbsp;<span class="s">&quot;Keymap used in JavaScript mode.&quot;</span><span class="p">)</span></div><div class="line" id="LC84">&nbsp;</div><div class="line" id="LC85"><span class="p">(</span><span class="nf">unless</span> <span class="nv">javascript-mode-map</span> </div><div class="line" id="LC86">&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">javascript-mode-map</span> <span class="p">(</span><span class="nf">make-sparse-keymap</span><span class="p">)))</span></div><div class="line" id="LC87">&nbsp;</div><div class="line" id="LC88"><span class="p">(</span><span class="nf">when</span> <span class="nv">javascript-auto-indent-flag</span></div><div class="line" id="LC89">&nbsp;&nbsp;<span class="p">(</span><span class="nf">mapc</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">key</span><span class="p">)</span> </div><div class="line" id="LC90">&nbsp;&nbsp;  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">javascript-mode-map</span> <span class="nv">key</span> <span class="ss">&#39;javascript-insert-and-indent</span><span class="p">))</span></div><div class="line" id="LC91">&nbsp;&nbsp;<span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;{&quot;</span> <span class="s">&quot;}&quot;</span> <span class="s">&quot;(&quot;</span> <span class="s">&quot;)&quot;</span> <span class="s">&quot;:&quot;</span> <span class="s">&quot;;&quot;</span> <span class="s">&quot;,&quot;</span><span class="p">)))</span></div><div class="line" id="LC92">&nbsp;</div><div class="line" id="LC93"><span class="p">(</span><span class="nf">defun</span> <span class="nv">javascript-insert-and-indent</span> <span class="p">(</span><span class="nf">key</span><span class="p">)</span></div><div class="line" id="LC94">&nbsp;&nbsp;<span class="s">&quot;Run command bound to key and indent current line. Runs the command</span></div><div class="line" id="LC95"><span class="s">bound to KEY in the global keymap and indents the current line.&quot;</span></div><div class="line" id="LC96">&nbsp;&nbsp;<span class="p">(</span><span class="nf">interactive</span> <span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nf">this-command-keys</span><span class="p">)))</span></div><div class="line" id="LC97">&nbsp;&nbsp;<span class="p">(</span><span class="nf">call-interactively</span> <span class="p">(</span><span class="nf">lookup-key</span> <span class="p">(</span><span class="nf">current-global-map</span><span class="p">)</span> <span class="nv">key</span><span class="p">))</span></div><div class="line" id="LC98">&nbsp;&nbsp;<span class="p">(</span><span class="nf">indent-according-to-mode</span><span class="p">))</span></div><div class="line" id="LC99">&nbsp;</div><div class="line" id="LC100">&nbsp;</div><div class="line" id="LC101"><span class="c1">;; --- Syntax Table And Parsing ---</span></div><div class="line" id="LC102">&nbsp;</div><div class="line" id="LC103"><span class="p">(</span><span class="nf">defvar</span> <span class="nv">javascript-mode-syntax-table</span></div><div class="line" id="LC104">&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">table</span> <span class="p">(</span><span class="nf">make-syntax-table</span><span class="p">)))</span></div><div class="line" id="LC105">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">c-populate-syntax-table</span> <span class="nv">table</span><span class="p">)</span></div><div class="line" id="LC106">&nbsp;</div><div class="line" id="LC107">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; The syntax class of underscore should really be `symbol&#39; (&quot;_&quot;)</span></div><div class="line" id="LC108">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; but that makes matching of tokens much more complex as e.g.</span></div><div class="line" id="LC109">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; &quot;\\&lt;xyz\\&gt;&quot; matches part of e.g. &quot;_xyz&quot; and &quot;xyz_abc&quot;. Defines</span></div><div class="line" id="LC110">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; it as word constituent for now.</span></div><div class="line" id="LC111">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">modify-syntax-entry</span> <span class="nv">?_</span> <span class="s">&quot;w&quot;</span> <span class="nv">table</span><span class="p">)</span></div><div class="line" id="LC112">&nbsp;</div><div class="line" id="LC113">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">table</span><span class="p">)</span></div><div class="line" id="LC114">&nbsp;&nbsp;<span class="s">&quot;Syntax table used in JavaScript mode.&quot;</span><span class="p">)</span></div><div class="line" id="LC115">&nbsp;</div><div class="line" id="LC116">&nbsp;</div><div class="line" id="LC117"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-re-search-forward-inner</span> <span class="p">(</span><span class="nf">regexp</span> <span class="nv">&amp;optional</span> <span class="nv">bound</span> <span class="nv">count</span><span class="p">)</span></div><div class="line" id="LC118">&nbsp;&nbsp;<span class="s">&quot;Auxiliary function for `js-re-search-forward&#39;.&quot;</span></div><div class="line" id="LC119">&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">parse</span><span class="p">)</span></div><div class="line" id="LC120">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">saved-point</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">)))</span></div><div class="line" id="LC121">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nb">&gt; </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span></div><div class="line" id="LC122">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">re-search-forward</span> <span class="nv">regexp</span> <span class="nv">bound</span><span class="p">)</span></div><div class="line" id="LC123">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">parse</span> <span class="p">(</span><span class="nf">parse-partial-sexp</span> <span class="nv">saved-point</span> <span class="p">(</span><span class="nf">point</span><span class="p">)))</span></div><div class="line" id="LC124">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nf">nth</span> <span class="mi">3</span> <span class="nv">parse</span><span class="p">)</span></div><div class="line" id="LC125">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">re-search-forward</span> </div><div class="line" id="LC126">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">concat</span> <span class="s">&quot;\\([^\\]\\|^\\)&quot;</span> <span class="p">(</span><span class="nb">string </span><span class="p">(</span><span class="nf">nth</span> <span class="mi">3</span> <span class="nv">parse</span><span class="p">)))</span> </div><div class="line" id="LC127">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span> <span class="p">(</span><span class="nf">end-of-line</span><span class="p">)</span> <span class="p">(</span><span class="nf">point</span><span class="p">))</span> <span class="nv">t</span><span class="p">))</span></div><div class="line" id="LC128">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">((</span><span class="nf">nth</span> <span class="mi">7</span> <span class="nv">parse</span><span class="p">)</span></div><div class="line" id="LC129">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span><span class="p">))</span></div><div class="line" id="LC130">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nf">nth</span> <span class="mi">4</span> <span class="nv">parse</span><span class="p">)</span></div><div class="line" id="LC131">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eq</span> <span class="p">(</span><span class="nf">char-before</span><span class="p">)</span> <span class="nv">?</span><span class="err">\</span><span class="nv">/</span><span class="p">)</span> <span class="p">(</span><span class="nf">eq</span> <span class="p">(</span><span class="nf">char-after</span><span class="p">)</span> <span class="nv">?</span><span class="err">\</span><span class="nv">*</span><span class="p">)))</span></div><div class="line" id="LC132">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">re-search-forward</span> <span class="s">&quot;\\*/&quot;</span><span class="p">))</span></div><div class="line" id="LC133">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">t</span></div><div class="line" id="LC134">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">count</span> <span class="p">(</span><span class="mi">1</span><span class="nv">-</span> <span class="nv">count</span><span class="p">))))</span></div><div class="line" id="LC135">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">saved-point</span> <span class="p">(</span><span class="nf">point</span><span class="p">))))</span></div><div class="line" id="LC136">&nbsp;&nbsp;<span class="p">(</span><span class="nf">point</span><span class="p">))</span></div><div class="line" id="LC137">&nbsp;</div><div class="line" id="LC138">&nbsp;</div><div class="line" id="LC139"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-re-search-forward</span> <span class="p">(</span><span class="nf">regexp</span> <span class="nv">&amp;optional</span> <span class="nv">bound</span> <span class="nv">noerror</span> <span class="nv">count</span><span class="p">)</span></div><div class="line" id="LC140">&nbsp;&nbsp;<span class="s">&quot;Search forward but ignore strings and comments. Invokes</span></div><div class="line" id="LC141"><span class="s">`re-search-forward&#39; but treats the buffer as if strings and</span></div><div class="line" id="LC142"><span class="s">comments have been removed.&quot;</span></div><div class="line" id="LC143">&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">saved-point</span> <span class="p">(</span><span class="nf">point</span><span class="p">))</span></div><div class="line" id="LC144">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">search-expr</span> </div><div class="line" id="LC145">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nf">null</span> <span class="nv">count</span><span class="p">)</span></div><div class="line" id="LC146">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">&#39;</span><span class="p">(</span><span class="nv">js-re-search-forward-inner</span> <span class="nv">regexp</span> <span class="nv">bound</span> <span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC147">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">((</span><span class="nb">&lt; </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span></div><div class="line" id="LC148">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">&#39;</span><span class="p">(</span><span class="nv">js-re-search-backward-inner</span> <span class="nv">regexp</span> <span class="nv">bound</span> <span class="p">(</span><span class="nb">- </span><span class="nv">count</span><span class="p">)))</span></div><div class="line" id="LC149">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">((</span><span class="nb">&gt; </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span></div><div class="line" id="LC150">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">&#39;</span><span class="p">(</span><span class="nv">js-re-search-forward-inner</span> <span class="nv">regexp</span> <span class="nv">bound</span> <span class="nv">count</span><span class="p">)))))</span></div><div class="line" id="LC151">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">condition-case</span> <span class="nv">err</span></div><div class="line" id="LC152">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">eval </span><span class="nv">search-expr</span><span class="p">)</span></div><div class="line" id="LC153">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">search-failed</span></div><div class="line" id="LC154">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="nv">saved-point</span><span class="p">)</span></div><div class="line" id="LC155">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">unless</span> <span class="nv">noerror</span></div><div class="line" id="LC156">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">error</span> <span class="p">(</span><span class="nf">error-message-string</span> <span class="nv">err</span><span class="p">)))))))</span></div><div class="line" id="LC157">&nbsp;</div><div class="line" id="LC158">&nbsp;</div><div class="line" id="LC159"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-re-search-backward-inner</span> <span class="p">(</span><span class="nf">regexp</span> <span class="nv">&amp;optional</span> <span class="nv">bound</span> <span class="nv">count</span><span class="p">)</span></div><div class="line" id="LC160">&nbsp;&nbsp;<span class="s">&quot;Auxiliary function for `js-re-search-backward&#39;.&quot;</span></div><div class="line" id="LC161">&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">parse</span><span class="p">)</span></div><div class="line" id="LC162">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">saved-point</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">)))</span></div><div class="line" id="LC163">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nb">&gt; </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span></div><div class="line" id="LC164">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">re-search-backward</span> <span class="nv">regexp</span> <span class="nv">bound</span><span class="p">)</span></div><div class="line" id="LC165">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">point</span><span class="p">)</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span></div><div class="line" id="LC166">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span> <span class="p">(</span><span class="nf">backward-char</span><span class="p">)</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;/[/*]&quot;</span><span class="p">)))</span></div><div class="line" id="LC167">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-char</span><span class="p">))</span></div><div class="line" id="LC168">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">parse</span> <span class="p">(</span><span class="nf">parse-partial-sexp</span> <span class="nv">saved-point</span> <span class="p">(</span><span class="nf">point</span><span class="p">)))</span></div><div class="line" id="LC169">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nf">nth</span> <span class="mi">3</span> <span class="nv">parse</span><span class="p">)</span></div><div class="line" id="LC170">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">re-search-backward</span></div><div class="line" id="LC171">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">concat</span> <span class="s">&quot;\\([^\\]\\|^\\)&quot;</span> <span class="p">(</span><span class="nb">string </span><span class="p">(</span><span class="nf">nth</span> <span class="mi">3</span> <span class="nv">parse</span><span class="p">)))</span> </div><div class="line" id="LC172">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span> <span class="p">(</span><span class="nf">beginning-of-line</span><span class="p">)</span> <span class="p">(</span><span class="nf">point</span><span class="p">))</span> <span class="nv">t</span><span class="p">))</span></div><div class="line" id="LC173">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">((</span><span class="nf">nth</span> <span class="mi">7</span> <span class="nv">parse</span><span class="p">)</span> </div><div class="line" id="LC174">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">8</span> <span class="nv">parse</span><span class="p">)))</span></div><div class="line" id="LC175">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nf">nth</span> <span class="mi">4</span> <span class="nv">parse</span><span class="p">)</span></div><div class="line" id="LC176">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eq</span> <span class="p">(</span><span class="nf">char-before</span><span class="p">)</span> <span class="nv">?/</span><span class="p">)</span> <span class="p">(</span><span class="nf">eq</span> <span class="p">(</span><span class="nf">char-after</span><span class="p">)</span> <span class="nv">?*</span><span class="p">)))</span></div><div class="line" id="LC177">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">re-search-backward</span> <span class="s">&quot;/\\*&quot;</span><span class="p">))</span></div><div class="line" id="LC178">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">t</span></div><div class="line" id="LC179">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">count</span> <span class="p">(</span><span class="mi">1</span><span class="nv">-</span> <span class="nv">count</span><span class="p">))))))</span></div><div class="line" id="LC180">&nbsp;&nbsp;<span class="p">(</span><span class="nf">point</span><span class="p">))</span></div><div class="line" id="LC181">&nbsp;</div><div class="line" id="LC182">&nbsp;</div><div class="line" id="LC183"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-re-search-backward</span> <span class="p">(</span><span class="nf">regexp</span> <span class="nv">&amp;optional</span> <span class="nv">bound</span> <span class="nv">noerror</span> <span class="nv">count</span><span class="p">)</span></div><div class="line" id="LC184">&nbsp;&nbsp;<span class="s">&quot;Search backward but ignore strings and comments. Invokes</span></div><div class="line" id="LC185"><span class="s">`re-search-backward&#39; but treats the buffer as if strings and</span></div><div class="line" id="LC186"><span class="s">comments have been removed.&quot;</span></div><div class="line" id="LC187">&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">saved-point</span> <span class="p">(</span><span class="nf">point</span><span class="p">))</span></div><div class="line" id="LC188">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">search-expr</span> </div><div class="line" id="LC189">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nf">null</span> <span class="nv">count</span><span class="p">)</span></div><div class="line" id="LC190">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">&#39;</span><span class="p">(</span><span class="nv">js-re-search-backward-inner</span> <span class="nv">regexp</span> <span class="nv">bound</span> <span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC191">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">((</span><span class="nb">&lt; </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span></div><div class="line" id="LC192">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">&#39;</span><span class="p">(</span><span class="nv">js-re-search-forward-inner</span> <span class="nv">regexp</span> <span class="nv">bound</span> <span class="p">(</span><span class="nb">- </span><span class="nv">count</span><span class="p">)))</span></div><div class="line" id="LC193">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">((</span><span class="nb">&gt; </span><span class="nv">count</span> <span class="mi">0</span><span class="p">)</span></div><div class="line" id="LC194">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">&#39;</span><span class="p">(</span><span class="nv">js-re-search-backward-inner</span> <span class="nv">regexp</span> <span class="nv">bound</span> <span class="nv">count</span><span class="p">)))))</span></div><div class="line" id="LC195">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">condition-case</span> <span class="nv">err</span></div><div class="line" id="LC196">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">eval </span><span class="nv">search-expr</span><span class="p">)</span></div><div class="line" id="LC197">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">search-failed</span></div><div class="line" id="LC198">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="nv">saved-point</span><span class="p">)</span></div><div class="line" id="LC199">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">unless</span> <span class="nv">noerror</span></div><div class="line" id="LC200">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">error</span> <span class="p">(</span><span class="nf">error-message-string</span> <span class="nv">err</span><span class="p">)))))))</span></div><div class="line" id="LC201">&nbsp;</div><div class="line" id="LC202">&nbsp;</div><div class="line" id="LC203"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-continued-var-decl-list-p</span> <span class="p">()</span></div><div class="line" id="LC204">&nbsp;&nbsp;<span class="s">&quot;Return non-nil if point is inside a continued variable declaration</span></div><div class="line" id="LC205"><span class="s">list.&quot;</span></div><div class="line" id="LC206">&nbsp;&nbsp;<span class="p">(</span><span class="nf">interactive</span><span class="p">)</span></div><div class="line" id="LC207">&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">start</span> <span class="p">(</span><span class="nf">save-excursion</span> <span class="p">(</span><span class="nf">js-re-search-backward</span> <span class="s">&quot;\\&lt;var\\&gt;&quot;</span> <span class="nv">nil</span> <span class="nv">t</span><span class="p">))))</span></div><div class="line" id="LC208">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">and </span><span class="nv">start</span></div><div class="line" id="LC209">&nbsp;&nbsp; <span class="p">(</span><span class="nf">save-excursion</span> <span class="p">(</span><span class="nf">re-search-backward</span> <span class="s">&quot;\n&quot;</span> <span class="nv">start</span> <span class="nv">t</span><span class="p">))</span></div><div class="line" id="LC210">&nbsp;&nbsp; <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC211">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">js-re-search-backward</span> </div><div class="line" id="LC212">&nbsp;&nbsp;&nbsp;&nbsp; <span class="s">&quot;;\\|[^, \t][ \t]*\\(/[/*]\\|$\\)&quot;</span> <span class="nv">start</span> <span class="nv">t</span><span class="p">))))))</span></div><div class="line" id="LC213">&nbsp;</div><div class="line" id="LC214">&nbsp;</div><div class="line" id="LC215"><span class="c1">;; --- Font Lock ---</span></div><div class="line" id="LC216">&nbsp;</div><div class="line" id="LC217"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-inside-param-list-p</span> <span class="p">()</span></div><div class="line" id="LC218">&nbsp;&nbsp;<span class="s">&quot;Return non-nil if point is inside a function parameter list.&quot;</span></div><div class="line" id="LC219">&nbsp;&nbsp;<span class="p">(</span><span class="nf">condition-case</span> <span class="nv">err</span></div><div class="line" id="LC220">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC221">&nbsp;&nbsp;<span class="p">(</span><span class="nf">up-list</span> <span class="mi">-1</span><span class="p">)</span></div><div class="line" id="LC222">&nbsp;&nbsp;<span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;(&quot;</span><span class="p">)</span></div><div class="line" id="LC223">&nbsp;&nbsp;     <span class="p">(</span><span class="nf">progn</span> <span class="p">(</span><span class="nf">backward-word</span> <span class="mi">1</span><span class="p">)</span></div><div class="line" id="LC224">&nbsp;&nbsp;&nbsp;&nbsp;    <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;function&quot;</span><span class="p">)</span></div><div class="line" id="LC225">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">progn</span> <span class="p">(</span><span class="nf">backward-word</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;function&quot;</span><span class="p">))))))</span></div><div class="line" id="LC226">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">error</span> <span class="nv">nil</span><span class="p">)))</span></div><div class="line" id="LC227">&nbsp;</div><div class="line" id="LC228">&nbsp;</div><div class="line" id="LC229"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-function-heading-1-re</span> </div><div class="line" id="LC230">&nbsp;&nbsp;<span class="s">&quot;^[ \t]*function[ \t]+\\(\\w+\\)&quot;</span></div><div class="line" id="LC231">&nbsp;&nbsp;<span class="s">&quot;Regular expression matching the start of a function header.&quot;</span><span class="p">)</span></div><div class="line" id="LC232">&nbsp;</div><div class="line" id="LC233"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-function-heading-2-re</span> </div><div class="line" id="LC234">&nbsp;&nbsp;<span class="s">&quot;^[ \t]*\\(\\w+\\)[ \t]*:[ \t]*function\\&gt;&quot;</span></div><div class="line" id="LC235">&nbsp;&nbsp;<span class="s">&quot;Regular expression matching the start of a function entry in</span></div><div class="line" id="LC236"><span class="s">  an associative array.&quot;</span><span class="p">)</span></div><div class="line" id="LC237">&nbsp;</div><div class="line" id="LC238"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-keyword-re</span></div><div class="line" id="LC239">&nbsp;&nbsp;<span class="p">(</span><span class="nf">regexp-opt</span> <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;abstract&quot;</span> <span class="s">&quot;break&quot;</span> <span class="s">&quot;case&quot;</span> <span class="s">&quot;catch&quot;</span> <span class="s">&quot;class&quot;</span> <span class="s">&quot;const&quot;</span></div><div class="line" id="LC240">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;continue&quot;</span> <span class="s">&quot;debugger&quot;</span> <span class="s">&quot;default&quot;</span> <span class="s">&quot;delete&quot;</span> <span class="s">&quot;do&quot;</span> <span class="s">&quot;else&quot;</span> </div><div class="line" id="LC241">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;enum&quot;</span> <span class="s">&quot;export&quot;</span> <span class="s">&quot;extends&quot;</span> <span class="s">&quot;final&quot;</span> <span class="s">&quot;finally&quot;</span> <span class="s">&quot;for&quot;</span> </div><div class="line" id="LC242">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;function&quot;</span> <span class="s">&quot;goto&quot;</span> <span class="s">&quot;if&quot;</span> <span class="s">&quot;implements&quot;</span> <span class="s">&quot;import&quot;</span> <span class="s">&quot;in&quot;</span> </div><div class="line" id="LC243">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;instanceof&quot;</span> <span class="s">&quot;interface&quot;</span> <span class="s">&quot;native&quot;</span> <span class="s">&quot;new&quot;</span> <span class="s">&quot;package&quot;</span> </div><div class="line" id="LC244">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;private&quot;</span> <span class="s">&quot;protected&quot;</span> <span class="s">&quot;public&quot;</span> <span class="s">&quot;return&quot;</span> <span class="s">&quot;static&quot;</span> </div><div class="line" id="LC245">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;super&quot;</span> <span class="s">&quot;switch&quot;</span> <span class="s">&quot;synchronized&quot;</span> <span class="s">&quot;this&quot;</span> <span class="s">&quot;throw&quot;</span> </div><div class="line" id="LC246">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;throws&quot;</span> <span class="s">&quot;transient&quot;</span> <span class="s">&quot;try&quot;</span> <span class="s">&quot;typeof&quot;</span> <span class="s">&quot;var&quot;</span> <span class="s">&quot;void&quot;</span> </div><div class="line" id="LC247">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;volatile&quot;</span> <span class="s">&quot;while&quot;</span> <span class="s">&quot;with&quot;</span></div><div class="line" id="LC248">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;let&quot;</span><span class="p">)</span> <span class="ss">&#39;words</span><span class="p">)</span></div><div class="line" id="LC249">&nbsp;&nbsp;<span class="s">&quot;Regular expression matching any JavaScript keyword.&quot;</span><span class="p">)</span></div><div class="line" id="LC250">&nbsp;</div><div class="line" id="LC251"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-basic-type-re</span></div><div class="line" id="LC252">&nbsp;&nbsp;<span class="p">(</span><span class="nf">regexp-opt</span> <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;boolean&quot;</span> <span class="s">&quot;byte&quot;</span> <span class="s">&quot;char&quot;</span> <span class="s">&quot;double&quot;</span> <span class="s">&quot;float&quot;</span> <span class="s">&quot;int&quot;</span> <span class="s">&quot;long&quot;</span></div><div class="line" id="LC253">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;short&quot;</span> <span class="s">&quot;void&quot;</span><span class="p">)</span> <span class="ss">&#39;words</span><span class="p">)</span></div><div class="line" id="LC254">&nbsp;&nbsp;<span class="s">&quot;Regular expression matching any predefined type in JavaScript.&quot;</span><span class="p">)</span></div><div class="line" id="LC255">&nbsp;</div><div class="line" id="LC256"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-constant-re</span></div><div class="line" id="LC257">&nbsp;&nbsp;<span class="p">(</span><span class="nf">regexp-opt</span> <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;false&quot;</span> <span class="s">&quot;null&quot;</span> <span class="s">&quot;true&quot;</span><span class="p">)</span> <span class="ss">&#39;words</span><span class="p">)</span></div><div class="line" id="LC258">&nbsp;&nbsp;<span class="s">&quot;Regular expression matching any future reserved words in JavaScript.&quot;</span><span class="p">)</span></div><div class="line" id="LC259">&nbsp;</div><div class="line" id="LC260">&nbsp;</div><div class="line" id="LC261"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-font-lock-keywords-1</span></div><div class="line" id="LC262">&nbsp;&nbsp;<span class="p">(</span><span class="nb">list </span></div><div class="line" id="LC263">&nbsp;&nbsp;&nbsp;<span class="s">&quot;\\&lt;import\\&gt;&quot;</span> </div><div class="line" id="LC264">&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">list </span><span class="nv">js-function-heading-1-re</span> <span class="mi">1</span> <span class="nv">font-lock-function-name-face</span><span class="p">)</span></div><div class="line" id="LC265">&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">list </span><span class="nv">js-function-heading-2-re</span> <span class="mi">1</span> <span class="nv">font-lock-function-name-face</span><span class="p">)</span></div><div class="line" id="LC266">&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">list </span><span class="s">&quot;[=(][ \t]*\\(/.*?[^\\]/\\w*\\)&quot;</span> <span class="mi">1</span> <span class="nv">font-lock-string-face</span><span class="p">))</span></div><div class="line" id="LC267">&nbsp;&nbsp;<span class="s">&quot;Level one font lock.&quot;</span><span class="p">)</span></div><div class="line" id="LC268">&nbsp;</div><div class="line" id="LC269"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-font-lock-keywords-2</span></div><div class="line" id="LC270">&nbsp;&nbsp;<span class="p">(</span><span class="nb">append </span><span class="nv">js-font-lock-keywords-1</span></div><div class="line" id="LC271">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nb">list </span><span class="nv">js-keyword-re</span> <span class="mi">1</span> <span class="nv">font-lock-keyword-face</span><span class="p">)</span></div><div class="line" id="LC272">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">cons </span><span class="nv">js-basic-type-re</span> <span class="nv">font-lock-type-face</span><span class="p">)</span></div><div class="line" id="LC273">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">cons </span><span class="nv">js-constant-re</span> <span class="nv">font-lock-constant-face</span><span class="p">)))</span></div><div class="line" id="LC274">&nbsp;&nbsp;<span class="s">&quot;Level two font lock.&quot;</span><span class="p">)</span></div><div class="line" id="LC275">&nbsp;</div><div class="line" id="LC276">&nbsp;</div><div class="line" id="LC277"><span class="c1">;; Limitations with variable declarations: There seems to be no</span></div><div class="line" id="LC278"><span class="c1">;; sensible way to highlight variables occuring after an initialized</span></div><div class="line" id="LC279"><span class="c1">;; variable in a variable list. For instance, in</span></div><div class="line" id="LC280"><span class="c1">;;</span></div><div class="line" id="LC281"><span class="c1">;;    var x, y = f(a, b), z</span></div><div class="line" id="LC282"><span class="c1">;;</span></div><div class="line" id="LC283"><span class="c1">;; z will not be highlighted.</span></div><div class="line" id="LC284">&nbsp;</div><div class="line" id="LC285"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-font-lock-keywords-3</span></div><div class="line" id="LC286">&nbsp;&nbsp;<span class="p">(</span><span class="nb">append </span></div><div class="line" id="LC287">&nbsp;&nbsp;&nbsp;<span class="nv">js-font-lock-keywords-2</span></div><div class="line" id="LC288">&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">list </span></div><div class="line" id="LC289">&nbsp;</div><div class="line" id="LC290">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; variable declarations</span></div><div class="line" id="LC291">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">list</span></div><div class="line" id="LC292">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">concat</span> <span class="s">&quot;\\&lt;\\(const\\|var\\)\\&gt;\\|&quot;</span> <span class="nv">js-basic-type-re</span><span class="p">)</span></div><div class="line" id="LC293">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">list </span><span class="s">&quot;\\(\\w+\\)[ \t]*\\([=;].*\\|,\\|/[/*]\\|$\\)&quot;</span></div><div class="line" id="LC294">&nbsp;&nbsp;   <span class="nv">nil</span></div><div class="line" id="LC295">&nbsp;&nbsp;   <span class="nv">nil</span></div><div class="line" id="LC296">&nbsp;&nbsp;   <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="nv">font-lock-variable-name-face</span><span class="p">)))</span></div><div class="line" id="LC297">&nbsp;</div><div class="line" id="LC298">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; continued variable declaration list</span></div><div class="line" id="LC299">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">list</span></div><div class="line" id="LC300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">concat</span> <span class="s">&quot;^[ \t]*\\w+[ \t]*\\([,;=]\\|/[/*]\\|$\\)&quot;</span><span class="p">)</span></div><div class="line" id="LC301">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">list </span><span class="s">&quot;\\(\\w+\\)[ \t]*\\([=;].*\\|,\\|/[/*]\\|$\\)&quot;</span></div><div class="line" id="LC302">&nbsp;&nbsp;   <span class="o">&#39;</span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">save-excursion</span> <span class="p">(</span><span class="nf">backward-char</span><span class="p">)</span> <span class="p">(</span><span class="nf">js-continued-var-decl-list-p</span><span class="p">))</span></div><div class="line" id="LC303">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">backward-word</span> <span class="mi">1</span><span class="p">)</span> </div><div class="line" id="LC304">&nbsp;&nbsp;      <span class="p">(</span><span class="nf">end-of-line</span><span class="p">))</span></div><div class="line" id="LC305">&nbsp;&nbsp;   <span class="o">&#39;</span><span class="p">(</span><span class="nv">end-of-line</span><span class="p">)</span></div><div class="line" id="LC306">&nbsp;&nbsp;   <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="nv">font-lock-variable-name-face</span><span class="p">)))</span></div><div class="line" id="LC307">&nbsp;</div><div class="line" id="LC308">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; formal parameters</span></div><div class="line" id="LC309">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">list</span></div><div class="line" id="LC310">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">concat</span> <span class="s">&quot;\\&lt;function\\&gt;\\([ \t]+\\w+\\)?[ \t]*([ \t]*\\w&quot;</span><span class="p">)</span></div><div class="line" id="LC311">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">list </span><span class="s">&quot;\\(\\w+\\)\\([ \t]*).*\\)?&quot;</span></div><div class="line" id="LC312">&nbsp;&nbsp;   <span class="o">&#39;</span><span class="p">(</span><span class="nv">backward-char</span><span class="p">)</span></div><div class="line" id="LC313">&nbsp;&nbsp;   <span class="o">&#39;</span><span class="p">(</span><span class="nv">end-of-line</span><span class="p">)</span></div><div class="line" id="LC314">&nbsp;&nbsp;   <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="nv">font-lock-variable-name-face</span><span class="p">)))</span></div><div class="line" id="LC315">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC316">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; continued formal parameter list</span></div><div class="line" id="LC317">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">list</span></div><div class="line" id="LC318">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">concat</span> <span class="s">&quot;^[ \t]*\\w+[ \t]*[,)]&quot;</span><span class="p">)</span></div><div class="line" id="LC319">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">list </span><span class="s">&quot;\\w+&quot;</span></div><div class="line" id="LC320">&nbsp;&nbsp;   <span class="o">&#39;</span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">save-excursion</span> <span class="p">(</span><span class="nf">backward-char</span><span class="p">)</span> <span class="p">(</span><span class="nf">js-inside-param-list-p</span><span class="p">))</span></div><div class="line" id="LC321">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">backward-word</span> <span class="mi">1</span><span class="p">)</span> </div><div class="line" id="LC322">&nbsp;&nbsp;      <span class="p">(</span><span class="nf">end-of-line</span><span class="p">))</span></div><div class="line" id="LC323">&nbsp;&nbsp;   <span class="o">&#39;</span><span class="p">(</span><span class="nv">end-of-line</span><span class="p">)</span></div><div class="line" id="LC324">&nbsp;&nbsp;   <span class="o">&#39;</span><span class="p">(</span><span class="mi">0</span> <span class="nv">font-lock-variable-name-face</span><span class="p">)))))</span></div><div class="line" id="LC325">&nbsp;&nbsp;<span class="s">&quot;Level three font lock.&quot;</span><span class="p">)</span></div><div class="line" id="LC326">&nbsp;</div><div class="line" id="LC327"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-font-lock-keywords</span></div><div class="line" id="LC328">&nbsp;&nbsp;<span class="o">&#39;</span><span class="p">(</span><span class="nv">js-font-lock-keywords-3</span> <span class="nv">js-font-lock-keywords-1</span> <span class="nv">js-font-lock-keywords-2</span></div><div class="line" id="LC329">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">js-font-lock-keywords-3</span><span class="p">)</span></div><div class="line" id="LC330">&nbsp;&nbsp;<span class="s">&quot;See `font-lock-keywords&#39;.&quot;</span><span class="p">)</span></div><div class="line" id="LC331">&nbsp;</div><div class="line" id="LC332">&nbsp;</div><div class="line" id="LC333"><span class="c1">;; --- Indentation ---</span></div><div class="line" id="LC334">&nbsp;</div><div class="line" id="LC335"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-possibly-braceless-keyword-re</span></div><div class="line" id="LC336">&nbsp;&nbsp;<span class="p">(</span><span class="nf">regexp-opt</span></div><div class="line" id="LC337">&nbsp;&nbsp;&nbsp;<span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;catch&quot;</span> <span class="s">&quot;do&quot;</span> <span class="s">&quot;else&quot;</span> <span class="s">&quot;finally&quot;</span> <span class="s">&quot;for&quot;</span> <span class="s">&quot;if&quot;</span> <span class="s">&quot;try&quot;</span> <span class="s">&quot;while&quot;</span> <span class="s">&quot;with&quot;</span> <span class="s">&quot;let&quot;</span><span class="p">)</span></div><div class="line" id="LC338">&nbsp;&nbsp;&nbsp;<span class="ss">&#39;words</span><span class="p">)</span></div><div class="line" id="LC339">&nbsp;&nbsp;<span class="s">&quot;Regular expression matching keywords that are optionally</span></div><div class="line" id="LC340"><span class="s">  followed by an opening brace.&quot;</span><span class="p">)</span></div><div class="line" id="LC341">&nbsp;</div><div class="line" id="LC342"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-indent-operator-re</span></div><div class="line" id="LC343">&nbsp;&nbsp;<span class="p">(</span><span class="nf">concat</span> <span class="s">&quot;[-+*/%&lt;&gt;=&amp;^|?:.]\\([^-+*/]\\|$\\)\\|&quot;</span></div><div class="line" id="LC344">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">regexp-opt</span> <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;in&quot;</span> <span class="s">&quot;instanceof&quot;</span><span class="p">)</span> <span class="ss">&#39;words</span><span class="p">))</span></div><div class="line" id="LC345">&nbsp;&nbsp;<span class="s">&quot;Regular expression matching operators that affect indentation</span></div><div class="line" id="LC346"><span class="s">  of continued expressions.&quot;</span><span class="p">)</span></div><div class="line" id="LC347">&nbsp;</div><div class="line" id="LC348">&nbsp;</div><div class="line" id="LC349"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-looking-at-operator-p</span> <span class="p">()</span></div><div class="line" id="LC350">&nbsp;&nbsp;<span class="s">&quot;Return non-nil if text after point is an operator (that is not</span></div><div class="line" id="LC351"><span class="s">a comma).&quot;</span></div><div class="line" id="LC352">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-match-data</span></div><div class="line" id="LC353">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">looking-at</span> <span class="nv">js-indent-operator-re</span><span class="p">)</span></div><div class="line" id="LC354">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;:&quot;</span><span class="p">))</span></div><div class="line" id="LC355">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC356">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">js-re-search-backward</span> <span class="s">&quot;[?:{]\\|\\&lt;case\\&gt;&quot;</span> <span class="nv">nil</span> <span class="nv">t</span><span class="p">)</span></div><div class="line" id="LC357">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;?&quot;</span><span class="p">)))))))</span></div><div class="line" id="LC358">&nbsp;</div><div class="line" id="LC359">&nbsp;</div><div class="line" id="LC360"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-continued-expression-p</span> <span class="p">()</span></div><div class="line" id="LC361">&nbsp;&nbsp;<span class="s">&quot;Returns non-nil if the current line continues an expression.&quot;</span></div><div class="line" id="LC362">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC363">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">back-to-indentation</span><span class="p">)</span></div><div class="line" id="LC364">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">js-looking-at-operator-p</span><span class="p">)</span></div><div class="line" id="LC365">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">js-re-search-backward</span> <span class="s">&quot;\n&quot;</span> <span class="nv">nil</span> <span class="nv">t</span><span class="p">)</span></div><div class="line" id="LC366">&nbsp;&nbsp;     <span class="p">(</span><span class="nf">progn</span> </div><div class="line" id="LC367">&nbsp;&nbsp;       <span class="p">(</span><span class="nf">skip-chars-backward</span> <span class="s">&quot; \t&quot;</span><span class="p">)</span></div><div class="line" id="LC368">&nbsp;&nbsp;       <span class="p">(</span><span class="nf">backward-char</span><span class="p">)</span></div><div class="line" id="LC369">&nbsp;&nbsp;       <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">point</span><span class="p">)</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span></div><div class="line" id="LC370">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span> <span class="p">(</span><span class="nf">backward-char</span><span class="p">)</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;[/*]/&quot;</span><span class="p">)))</span></div><div class="line" id="LC371">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">js-looking-at-operator-p</span><span class="p">)</span></div><div class="line" id="LC372">&nbsp;&nbsp;&nbsp;&nbsp;    <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">progn</span> <span class="p">(</span><span class="nf">backward-char</span><span class="p">)</span></div><div class="line" id="LC373">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;++\\|--\\|/[/*]&quot;</span><span class="p">))))))))))</span></div><div class="line" id="LC374">&nbsp;</div><div class="line" id="LC375">&nbsp;</div><div class="line" id="LC376"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-end-of-do-while-loop-p</span> <span class="p">()</span></div><div class="line" id="LC377">&nbsp;&nbsp;<span class="s">&quot;Returns non-nil if word after point is `while&#39; of a do-while</span></div><div class="line" id="LC378"><span class="s">statement, else returns nil. A braceless do-while statement</span></div><div class="line" id="LC379"><span class="s">spanning several lines requires that the start of the loop is</span></div><div class="line" id="LC380"><span class="s">indented to the same column as the current line.&quot;</span></div><div class="line" id="LC381">&nbsp;&nbsp;<span class="p">(</span><span class="nf">interactive</span><span class="p">)</span></div><div class="line" id="LC382">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC383">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-match-data</span></div><div class="line" id="LC384">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;\\s-*\\&lt;while\\&gt;&quot;</span><span class="p">)</span></div><div class="line" id="LC385">&nbsp;&nbsp;<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC386">&nbsp;&nbsp;      <span class="p">(</span><span class="nf">skip-chars-backward</span> <span class="s">&quot;[ \t\n]*}&quot;</span><span class="p">)</span></div><div class="line" id="LC387">&nbsp;&nbsp;      <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;[ \t\n]*}&quot;</span><span class="p">))</span></div><div class="line" id="LC388">&nbsp;&nbsp;    <span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC389">&nbsp;&nbsp;      <span class="p">(</span><span class="nf">backward-list</span><span class="p">)</span> <span class="p">(</span><span class="nf">backward-word</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;\\&lt;do\\&gt;&quot;</span><span class="p">))</span></div><div class="line" id="LC390">&nbsp;&nbsp;  <span class="p">(</span><span class="nf">js-re-search-backward</span> <span class="s">&quot;\\&lt;do\\&gt;&quot;</span> <span class="p">(</span><span class="nf">point-at-bol</span><span class="p">)</span> <span class="nv">t</span><span class="p">)</span></div><div class="line" id="LC391">&nbsp;&nbsp;  <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;\\&lt;do\\&gt;&quot;</span><span class="p">)</span></div><div class="line" id="LC392">&nbsp;&nbsp;      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">saved-indent</span> <span class="p">(</span><span class="nf">current-indentation</span><span class="p">)))</span></div><div class="line" id="LC393">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">js-re-search-backward</span> <span class="s">&quot;^[ \t]*\\&lt;&quot;</span> <span class="nv">nil</span> <span class="nv">t</span><span class="p">)</span></div><div class="line" id="LC394">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="p">(</span><span class="nf">/=</span> <span class="p">(</span><span class="nf">current-indentation</span><span class="p">)</span> <span class="nv">saved-indent</span><span class="p">)))</span></div><div class="line" id="LC395">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;[ \t]*\\&lt;do\\&gt;&quot;</span><span class="p">)</span></div><div class="line" id="LC396">&nbsp;&nbsp;&nbsp;&nbsp;     <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">js-re-search-forward</span> </div><div class="line" id="LC397">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <span class="s">&quot;\\&lt;while\\&gt;&quot;</span> <span class="p">(</span><span class="nf">point-at-eol</span><span class="p">)</span> <span class="nv">t</span><span class="p">))</span></div><div class="line" id="LC398">&nbsp;&nbsp;&nbsp;&nbsp;     <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nf">current-indentation</span><span class="p">)</span> <span class="nv">saved-indent</span><span class="p">)))))))))</span></div><div class="line" id="LC399">&nbsp;</div><div class="line" id="LC400">&nbsp;</div><div class="line" id="LC401"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-ctrl-statement-indentation</span> <span class="p">()</span></div><div class="line" id="LC402">&nbsp;&nbsp;<span class="s">&quot;Returns the proper indentation of the current line if it</span></div><div class="line" id="LC403"><span class="s">starts the body of a control statement without braces, else</span></div><div class="line" id="LC404"><span class="s">returns nil.&quot;</span></div><div class="line" id="LC405">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC406">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">back-to-indentation</span><span class="p">)</span></div><div class="line" id="LC407">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC408">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;[{]&quot;</span><span class="p">))</span></div><div class="line" id="LC409">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">progn</span></div><div class="line" id="LC410">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">js-re-search-backward</span> <span class="s">&quot;[[:graph:]]&quot;</span> <span class="nv">nil</span> <span class="nv">t</span><span class="p">)</span></div><div class="line" id="LC411">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-char</span><span class="p">)</span></div><div class="line" id="LC412">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nf">char-before</span><span class="p">)</span> <span class="nv">?</span><span class="err">\</span><span class="p">))</span> <span class="p">(</span><span class="nf">backward-list</span><span class="p">))</span></div><div class="line" id="LC413">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">skip-syntax-backward</span> <span class="s">&quot; &quot;</span><span class="p">)</span></div><div class="line" id="LC414">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">skip-syntax-backward</span> <span class="s">&quot;w&quot;</span><span class="p">)</span></div><div class="line" id="LC415">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">looking-at</span> <span class="nv">js-possibly-braceless-keyword-re</span><span class="p">))</span></div><div class="line" id="LC416">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">js-end-of-do-while-loop-p</span><span class="p">))))</span></div><div class="line" id="LC417">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC418">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">match-beginning</span> <span class="mi">0</span><span class="p">))</span></div><div class="line" id="LC419">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">current-indentation</span><span class="p">)</span> <span class="nv">javascript-indent-level</span><span class="p">)))))</span></div><div class="line" id="LC420">&nbsp;</div><div class="line" id="LC421">&nbsp;</div><div class="line" id="LC422"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-proper-indentation</span> <span class="p">(</span><span class="nf">parse-status</span><span class="p">)</span></div><div class="line" id="LC423">&nbsp;&nbsp;<span class="s">&quot;Return the proper indentation for the current line.&quot;</span></div><div class="line" id="LC424">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC425">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">back-to-indentation</span><span class="p">)</span></div><div class="line" id="LC426">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">ctrl-stmt-indent</span> <span class="p">(</span><span class="nf">js-ctrl-statement-indentation</span><span class="p">))</span></div><div class="line" id="LC427">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">same-indent-p</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;[]})]\\|\\&lt;case\\&gt;\\|\\&lt;default\\&gt;&quot;</span><span class="p">))</span></div><div class="line" id="LC428">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">continued-expr-p</span> <span class="p">(</span><span class="nf">js-continued-expression-p</span><span class="p">)))</span></div><div class="line" id="LC429">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">cond </span><span class="p">(</span><span class="nf">ctrl-stmt-indent</span><span class="p">)</span></div><div class="line" id="LC430">&nbsp;&nbsp;    <span class="p">((</span><span class="nf">js-continued-var-decl-list-p</span><span class="p">)</span></div><div class="line" id="LC431">&nbsp;&nbsp;     <span class="p">(</span><span class="nf">js-re-search-backward</span> <span class="s">&quot;\\&lt;var\\&gt;&quot;</span> <span class="nv">nil</span> <span class="nv">t</span><span class="p">)</span></div><div class="line" id="LC432">&nbsp;&nbsp;     <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">current-indentation</span><span class="p">)</span> <span class="nv">javascript-indent-level</span><span class="p">))</span></div><div class="line" id="LC433">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">((</span><span class="nf">nth</span> <span class="mi">1</span> <span class="nv">parse-status</span><span class="p">)</span></div><div class="line" id="LC434">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">1</span> <span class="nv">parse-status</span><span class="p">))</span></div><div class="line" id="LC435">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;[({[][ \t]*\\(/[/*]\\|$\\)&quot;</span><span class="p">)</span></div><div class="line" id="LC436">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">progn</span></div><div class="line" id="LC437">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">skip-syntax-backward</span> <span class="s">&quot; &quot;</span><span class="p">)</span></div><div class="line" id="LC438">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nf">char-before</span><span class="p">)</span> <span class="nv">?</span><span class="err">\</span><span class="p">))</span> <span class="p">(</span><span class="nf">backward-list</span><span class="p">))</span></div><div class="line" id="LC439">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">back-to-indentation</span><span class="p">)</span></div><div class="line" id="LC440">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">cond </span><span class="p">(</span><span class="nf">same-indent-p</span></div><div class="line" id="LC441">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">current-column</span><span class="p">))</span></div><div class="line" id="LC442">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">continued-expr-p</span></div><div class="line" id="LC443">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">current-column</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">javascript-indent-level</span><span class="p">)))</span></div><div class="line" id="LC444">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">t</span></div><div class="line" id="LC445">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">current-column</span><span class="p">)</span> <span class="nv">javascript-indent-level</span><span class="p">))))</span></div><div class="line" id="LC446">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">unless</span> <span class="nv">same-indent-p</span></div><div class="line" id="LC447">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-char</span><span class="p">)</span></div><div class="line" id="LC448">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">skip-chars-forward</span> <span class="s">&quot; \t&quot;</span><span class="p">))</span></div><div class="line" id="LC449">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">current-column</span><span class="p">)))</span></div><div class="line" id="LC450">&nbsp;&nbsp;    <span class="p">(</span><span class="nf">continued-expr-p</span> <span class="nv">javascript-indent-level</span><span class="p">)</span></div><div class="line" id="LC451">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">t</span> <span class="mi">0</span><span class="p">)))))</span></div><div class="line" id="LC452">&nbsp;</div><div class="line" id="LC453">&nbsp;</div><div class="line" id="LC454"><span class="p">(</span><span class="nf">defun</span> <span class="nv">javascript-indent-line</span> <span class="p">()</span></div><div class="line" id="LC455">&nbsp;&nbsp;<span class="s">&quot;Indent the current line as JavaScript source text.&quot;</span></div><div class="line" id="LC456">&nbsp;&nbsp;<span class="p">(</span><span class="nf">interactive</span><span class="p">)</span></div><div class="line" id="LC457">&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">parse-status</span> </div><div class="line" id="LC458">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span> <span class="p">(</span><span class="nf">parse-partial-sexp</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">)</span> <span class="p">(</span><span class="nf">point-at-bol</span><span class="p">))))</span></div><div class="line" id="LC459">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">offset</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">current-column</span><span class="p">)</span> <span class="p">(</span><span class="nf">current-indentation</span><span class="p">))))</span></div><div class="line" id="LC460">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">nth</span> <span class="mi">8</span> <span class="nv">parse-status</span><span class="p">))</span></div><div class="line" id="LC461">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">indent-line-to</span> <span class="p">(</span><span class="nf">js-proper-indentation</span> <span class="nv">parse-status</span><span class="p">))</span></div><div class="line" id="LC462">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nb">&gt; </span><span class="nv">offset</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">forward-char</span> <span class="nv">offset</span><span class="p">)))))</span></div><div class="line" id="LC463">&nbsp;</div><div class="line" id="LC464">&nbsp;</div><div class="line" id="LC465"><span class="c1">;; --- Filling ---</span></div><div class="line" id="LC466">&nbsp;</div><div class="line" id="LC467"><span class="c1">;; FIXME: It should be possible to use the more sofisticated function</span></div><div class="line" id="LC468"><span class="c1">;; `c-fill-paragraph&#39; in `cc-cmds.el&#39; instead. However, just setting</span></div><div class="line" id="LC469"><span class="c1">;; `fill-paragraph-function&#39; to `c-fill-paragraph&#39; does not work;</span></div><div class="line" id="LC470"><span class="c1">;; inside `c-fill-paragraph&#39;, `fill-paragraph-function&#39; evaluates to</span></div><div class="line" id="LC471"><span class="c1">;; nil!?</span></div><div class="line" id="LC472">&nbsp;</div><div class="line" id="LC473"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-backward-paragraph</span> <span class="p">()</span></div><div class="line" id="LC474">&nbsp;&nbsp;<span class="s">&quot;Move backward to start of paragraph. Postcondition: Point is at</span></div><div class="line" id="LC475"><span class="s">beginning of buffer or the previous line contains only whitespace.&quot;</span></div><div class="line" id="LC476">&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span> <span class="mi">-1</span><span class="p">)</span></div><div class="line" id="LC477">&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">bobp</span><span class="p">)</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;^[ \t]*$&quot;</span><span class="p">)))</span></div><div class="line" id="LC478">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span> <span class="mi">-1</span><span class="p">))</span></div><div class="line" id="LC479">&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">bobp</span><span class="p">))</span> <span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">)))</span></div><div class="line" id="LC480">&nbsp;</div><div class="line" id="LC481">&nbsp;</div><div class="line" id="LC482"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-forward-paragraph</span> <span class="p">()</span></div><div class="line" id="LC483">&nbsp;&nbsp;<span class="s">&quot;Move forward to end of paragraph. Postcondition: Point is at</span></div><div class="line" id="LC484"><span class="s">end of buffer or the next line contains only whitespace.&quot;</span></div><div class="line" id="LC485">&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">)</span></div><div class="line" id="LC486">&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">eobp</span><span class="p">)</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;^[ \t]*$&quot;</span><span class="p">)))</span></div><div class="line" id="LC487">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC488">&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">eobp</span><span class="p">))</span> <span class="p">(</span><span class="nf">backward-char</span> <span class="mi">1</span><span class="p">)))</span></div><div class="line" id="LC489">&nbsp;</div><div class="line" id="LC490">&nbsp;</div><div class="line" id="LC491"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-fill-block-comment-paragraph</span> <span class="p">(</span><span class="nf">parse-status</span> <span class="nv">justify</span><span class="p">)</span></div><div class="line" id="LC492">&nbsp;&nbsp;<span class="s">&quot;Fill current paragraph as a block comment. PARSE-STATUS is the</span></div><div class="line" id="LC493"><span class="s">result of `parse-partial-regexp&#39; from beginning of buffer to</span></div><div class="line" id="LC494"><span class="s">point. JUSTIFY has the same meaning as in `fill-paragraph&#39;.&quot;</span></div><div class="line" id="LC495">&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">offset</span> <span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC496">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">8</span> <span class="nv">parse-status</span><span class="p">))</span> <span class="p">(</span><span class="nf">current-indentation</span><span class="p">))))</span></div><div class="line" id="LC497">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC498">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-restriction</span></div><div class="line" id="LC499">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">narrow-to-region</span> <span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC500">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">8</span> <span class="nv">parse-status</span><span class="p">))</span> <span class="p">(</span><span class="nf">point-at-bol</span><span class="p">))</span></div><div class="line" id="LC501">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC502">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">8</span> <span class="nv">parse-status</span><span class="p">))</span></div><div class="line" id="LC503">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="p">(</span><span class="nf">re-search-forward</span> <span class="s">&quot;*/&quot;</span><span class="p">)))</span></div><div class="line" id="LC504">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">narrow-to-region</span> <span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC505">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">js-backward-paragraph</span><span class="p">)</span></div><div class="line" id="LC506">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;^[ \t]*$&quot;</span><span class="p">)</span> <span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC507">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">point</span><span class="p">))</span></div><div class="line" id="LC508">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC509">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">js-forward-paragraph</span><span class="p">)</span> </div><div class="line" id="LC510">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;^[ \t]*$&quot;</span><span class="p">)</span> <span class="p">(</span><span class="nf">backward-char</span><span class="p">))</span></div><div class="line" id="LC511">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">point</span><span class="p">)))</span></div><div class="line" id="LC512">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span></div><div class="line" id="LC513">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">eobp</span><span class="p">))</span></div><div class="line" id="LC514">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">delete-horizontal-space</span><span class="p">)</span></div><div class="line" id="LC515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC516">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">fill-column</span> <span class="p">(</span><span class="nb">- </span><span class="nv">fill-column</span> <span class="nv">offset</span><span class="p">))</span></div><div class="line" id="LC517">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">fill-paragraph-function</span> <span class="nv">nil</span><span class="p">))</span></div><div class="line" id="LC518">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">fill-paragraph</span> <span class="nv">justify</span><span class="p">))</span></div><div class="line" id="LC519">&nbsp;</div><div class="line" id="LC520">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; In Emacs 21.4 as opposed to CVS Emacs 22,</span></div><div class="line" id="LC521">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; `fill-paragraph&#39; seems toadd a newline at the end of the</span></div><div class="line" id="LC522">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; paragraph. Remove it!</span></div><div class="line" id="LC523">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))</span></div><div class="line" id="LC524">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;^$&quot;</span><span class="p">)</span> <span class="p">(</span><span class="nf">backward-delete-char</span> <span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC525">&nbsp;</div><div class="line" id="LC526">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span></div><div class="line" id="LC527">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">eobp</span><span class="p">))</span></div><div class="line" id="LC528">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">indent-to</span> <span class="nv">offset</span><span class="p">)</span></div><div class="line" id="LC529">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">))))))</span></div><div class="line" id="LC530">&nbsp;</div><div class="line" id="LC531">&nbsp;</div><div class="line" id="LC532"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-sline-comment-par-start</span> <span class="p">()</span></div><div class="line" id="LC533">&nbsp;&nbsp;<span class="s">&quot;Return point at the beginning of the line where the current</span></div><div class="line" id="LC534"><span class="s">single-line comment paragraph starts.&quot;</span></div><div class="line" id="LC535">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC536">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">beginning-of-line</span><span class="p">)</span></div><div class="line" id="LC537">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">bobp</span><span class="p">))</span> </div><div class="line" id="LC538">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;^[ \t]*//[ \t]*[[:graph:]]&quot;</span><span class="p">))</span></div><div class="line" id="LC539">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span> <span class="mi">-1</span><span class="p">))</span></div><div class="line" id="LC540">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">unless</span> <span class="p">(</span><span class="nf">bobp</span><span class="p">)</span> <span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC541">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">point</span><span class="p">)))</span></div><div class="line" id="LC542">&nbsp;</div><div class="line" id="LC543">&nbsp;</div><div class="line" id="LC544"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-sline-comment-par-end</span> <span class="p">()</span></div><div class="line" id="LC545">&nbsp;&nbsp;<span class="s">&quot;Return point at end of current single-line comment paragraph.&quot;</span></div><div class="line" id="LC546">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC547">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">beginning-of-line</span><span class="p">)</span></div><div class="line" id="LC548">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">eobp</span><span class="p">))</span> </div><div class="line" id="LC549">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;^[ \t]*//[ \t]*[[:graph:]]&quot;</span><span class="p">))</span></div><div class="line" id="LC550">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC551">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">unless</span> <span class="p">(</span><span class="nf">bobp</span><span class="p">)</span> <span class="p">(</span><span class="nf">backward-char</span><span class="p">))</span></div><div class="line" id="LC552">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">point</span><span class="p">)))</span></div><div class="line" id="LC553">&nbsp;</div><div class="line" id="LC554">&nbsp;</div><div class="line" id="LC555"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-sline-comment-offset</span> <span class="p">(</span><span class="nf">line</span><span class="p">)</span></div><div class="line" id="LC556">&nbsp;&nbsp;<span class="s">&quot;Return the column at the start of the current single-line</span></div><div class="line" id="LC557"><span class="s">comment paragraph.&quot;</span></div><div class="line" id="LC558">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC559">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-line</span> <span class="nv">line</span><span class="p">)</span></div><div class="line" id="LC560">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">re-search-forward</span> <span class="s">&quot;//&quot;</span> <span class="p">(</span><span class="nf">point-at-eol</span><span class="p">))</span></div><div class="line" id="LC561">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">match-beginning</span> <span class="mi">0</span><span class="p">))</span></div><div class="line" id="LC562">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">current-column</span><span class="p">)))</span></div><div class="line" id="LC563">&nbsp;</div><div class="line" id="LC564">&nbsp;</div><div class="line" id="LC565"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-sline-comment-text-offset</span> <span class="p">(</span><span class="nf">line</span><span class="p">)</span></div><div class="line" id="LC566">&nbsp;&nbsp;<span class="s">&quot;Return the column at the start of the text of the current</span></div><div class="line" id="LC567"><span class="s">single-line comment paragraph.&quot;</span></div><div class="line" id="LC568">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC569">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-line</span> <span class="nv">line</span><span class="p">)</span></div><div class="line" id="LC570">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">re-search-forward</span> <span class="s">&quot;//[ \t]*&quot;</span> <span class="p">(</span><span class="nf">point-at-eol</span><span class="p">))</span></div><div class="line" id="LC571">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">current-column</span><span class="p">)))</span></div><div class="line" id="LC572">&nbsp;</div><div class="line" id="LC573">&nbsp;</div><div class="line" id="LC574"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-at-empty-sline-comment-p</span> <span class="p">()</span></div><div class="line" id="LC575">&nbsp;&nbsp;<span class="s">&quot;Return non-nil if inside an empty single-line comment.&quot;</span></div><div class="line" id="LC576">&nbsp;&nbsp;<span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC577">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">beginning-of-line</span><span class="p">)</span></div><div class="line" id="LC578">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;^.*//.*[[:graph:]]&quot;</span><span class="p">)))</span></div><div class="line" id="LC579">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC580">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">re-search-backward</span> <span class="s">&quot;//&quot;</span> <span class="p">(</span><span class="nf">point-at-bol</span><span class="p">)</span> <span class="nv">t</span><span class="p">))))</span></div><div class="line" id="LC581">&nbsp;</div><div class="line" id="LC582">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC583"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-fill-sline-comments</span> <span class="p">(</span><span class="nf">parse-status</span> <span class="nv">justify</span><span class="p">)</span></div><div class="line" id="LC584">&nbsp;&nbsp;<span class="s">&quot;Fill current paragraph as a sequence of single-line comments.</span></div><div class="line" id="LC585"><span class="s">PARSE-STATUS is the result of `parse-partial-regexp&#39; from</span></div><div class="line" id="LC586"><span class="s">beginning of buffer to point. JUSTIFY has the same meaning as in</span></div><div class="line" id="LC587"><span class="s">`fill-paragraph&#39;.&quot;</span></div><div class="line" id="LC588">&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">js-at-empty-sline-comment-p</span><span class="p">))</span></div><div class="line" id="LC589">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">let* </span><span class="p">((</span><span class="nf">start</span> <span class="p">(</span><span class="nf">js-sline-comment-par-start</span><span class="p">))</span></div><div class="line" id="LC590">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">start-line</span> <span class="p">(</span><span class="mi">1</span><span class="nv">+</span> <span class="p">(</span><span class="nf">count-lines</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">)</span> <span class="nv">start</span><span class="p">)))</span></div><div class="line" id="LC591">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">end</span> <span class="p">(</span><span class="nf">js-sline-comment-par-end</span><span class="p">))</span></div><div class="line" id="LC592">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">offset</span> <span class="p">(</span><span class="nf">js-sline-comment-offset</span> <span class="nv">start-line</span><span class="p">))</span></div><div class="line" id="LC593">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">text-offset</span> <span class="p">(</span><span class="nf">js-sline-comment-text-offset</span> <span class="nv">start-line</span><span class="p">)))</span></div><div class="line" id="LC594">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span></div><div class="line" id="LC595">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-restriction</span></div><div class="line" id="LC596">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">narrow-to-region</span> <span class="nv">start</span> <span class="nv">end</span><span class="p">)</span></div><div class="line" id="LC597">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span></div><div class="line" id="LC598">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nf">re-search-forward</span> <span class="s">&quot;^[ \t]*//[ \t]*&quot;</span> <span class="nv">nil</span> <span class="nv">t</span><span class="p">)</span></div><div class="line" id="LC599">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">replace-match</span> <span class="s">&quot;&quot;</span><span class="p">)</span></div><div class="line" id="LC600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC601">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">fill-paragraph-function</span> <span class="nv">nil</span><span class="p">)</span></div><div class="line" id="LC602">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">fill-column</span> <span class="p">(</span><span class="nb">- </span><span class="nv">fill-column</span> <span class="nv">text-offset</span><span class="p">)))</span></div><div class="line" id="LC603">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">fill-paragraph</span> <span class="nv">justify</span><span class="p">))</span></div><div class="line" id="LC604">&nbsp;</div><div class="line" id="LC605">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; In Emacs 21.4 as opposed to CVS Emacs 22,</span></div><div class="line" id="LC606">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; `fill-paragraph&#39; seems toadd a newline at the end of the</span></div><div class="line" id="LC607">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">;; paragraph. Remove it!</span></div><div class="line" id="LC608">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))</span></div><div class="line" id="LC609">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;^$&quot;</span><span class="p">)</span> <span class="p">(</span><span class="nf">backward-delete-char</span> <span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC610">&nbsp;</div><div class="line" id="LC611">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span></div><div class="line" id="LC612">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">eobp</span><span class="p">))</span></div><div class="line" id="LC613">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">indent-to</span> <span class="nv">offset</span><span class="p">)</span></div><div class="line" id="LC614">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">insert</span> <span class="s">&quot;//&quot;</span><span class="p">)</span></div><div class="line" id="LC615">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">indent-to</span> <span class="nv">text-offset</span><span class="p">)</span></div><div class="line" id="LC616">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">)))))))</span></div><div class="line" id="LC617">&nbsp;&nbsp;</div><div class="line" id="LC618">&nbsp;</div><div class="line" id="LC619"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-trailing-comment-p</span> <span class="p">(</span><span class="nf">parse-status</span><span class="p">)</span></div><div class="line" id="LC620">&nbsp;&nbsp;<span class="s">&quot;Return non-nil if inside a trailing comment. PARSE-STATUS is</span></div><div class="line" id="LC621"><span class="s">the result of `parse-partial-regexp&#39; from beginning of buffer to</span></div><div class="line" id="LC622"><span class="s">point.&quot;</span></div><div class="line" id="LC623">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC624">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">4</span> <span class="nv">parse-status</span><span class="p">)</span></div><div class="line" id="LC625">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">8</span> <span class="nv">parse-status</span><span class="p">))</span></div><div class="line" id="LC626">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">skip-chars-backward</span> <span class="s">&quot; \t&quot;</span><span class="p">)</span></div><div class="line" id="LC627">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">bolp</span><span class="p">)))))</span></div><div class="line" id="LC628">&nbsp;</div><div class="line" id="LC629">&nbsp;</div><div class="line" id="LC630"><span class="p">(</span><span class="nf">defun</span> <span class="nv">js-block-comment-p</span> <span class="p">(</span><span class="nf">parse-status</span><span class="p">)</span></div><div class="line" id="LC631">&nbsp;&nbsp;<span class="s">&quot;Return non-nil if inside a block comment. PARSE-STATUS is the</span></div><div class="line" id="LC632"><span class="s">result of `parse-partial-regexp&#39; from beginning of buffer to</span></div><div class="line" id="LC633"><span class="s">point.&quot;</span></div><div class="line" id="LC634">&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-excursion</span> </div><div class="line" id="LC635">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">save-match-data</span></div><div class="line" id="LC636">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">4</span> <span class="nv">parse-status</span><span class="p">)</span></div><div class="line" id="LC637">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">8</span> <span class="nv">parse-status</span><span class="p">))</span></div><div class="line" id="LC638">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">looking-at</span> <span class="s">&quot;/\\*&quot;</span><span class="p">)))))</span></div><div class="line" id="LC639">&nbsp;</div><div class="line" id="LC640">&nbsp;</div><div class="line" id="LC641"><span class="p">(</span><span class="nf">defun</span> <span class="nv">javascript-fill-paragraph</span> <span class="p">(</span><span class="nf">&amp;optional</span> <span class="nv">justify</span><span class="p">)</span></div><div class="line" id="LC642">&nbsp;&nbsp;<span class="s">&quot;If inside a comment, fill the current comment paragraph.</span></div><div class="line" id="LC643"><span class="s">Trailing comments are ignored.&quot;</span></div><div class="line" id="LC644">&nbsp;&nbsp;<span class="p">(</span><span class="nf">interactive</span><span class="p">)</span></div><div class="line" id="LC645">&nbsp;&nbsp;<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">parse-status</span> <span class="p">(</span><span class="nf">parse-partial-sexp</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">)</span> <span class="p">(</span><span class="nf">point</span><span class="p">))))</span></div><div class="line" id="LC646">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">nth</span> <span class="mi">4</span> <span class="nv">parse-status</span><span class="p">)</span> </div><div class="line" id="LC647">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">js-trailing-comment-p</span> <span class="nv">parse-status</span><span class="p">)))</span></div><div class="line" id="LC648">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">js-block-comment-p</span> <span class="nv">parse-status</span><span class="p">)</span></div><div class="line" id="LC649">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">js-fill-block-comment-paragraph</span> <span class="nv">parse-status</span> <span class="nv">justify</span><span class="p">)</span></div><div class="line" id="LC650">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">js-fill-sline-comments</span> <span class="nv">parse-status</span> <span class="nv">justify</span><span class="p">))))</span></div><div class="line" id="LC651">&nbsp;&nbsp;<span class="nv">t</span><span class="p">)</span></div><div class="line" id="LC652">&nbsp;</div><div class="line" id="LC653">&nbsp;</div><div class="line" id="LC654"><span class="c1">;; --- Imenu ---</span></div><div class="line" id="LC655">&nbsp;</div><div class="line" id="LC656"><span class="p">(</span><span class="nf">defconst</span> <span class="nv">js-imenu-generic-expression</span> </div><div class="line" id="LC657">&nbsp;&nbsp;<span class="p">(</span><span class="nf">list</span></div><div class="line" id="LC658">&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="nf">list</span></div><div class="line" id="LC659">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">nil</span> </div><div class="line" id="LC660">&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;function\\s-+\\(\\w+\\)\\s-*(&quot;</span></div><div class="line" id="LC661">&nbsp;&nbsp;&nbsp;&nbsp;<span class="mi">1</span><span class="p">))</span></div><div class="line" id="LC662">&nbsp;&nbsp;<span class="s">&quot;Regular expression matching top level procedures. Used by imenu.&quot;</span><span class="p">)</span></div><div class="line" id="LC663">&nbsp;</div><div class="line" id="LC664">&nbsp;</div><div class="line" id="LC665"><span class="c1">;; --- Main Function ---</span></div><div class="line" id="LC666">&nbsp;</div><div class="line" id="LC667"><span class="c1">;;;###autoload</span></div><div class="line" id="LC668"><span class="p">(</span><span class="nf">defun</span> <span class="nv">javascript-mode</span> <span class="p">()</span></div><div class="line" id="LC669">&nbsp;&nbsp;<span class="s">&quot;Major mode for editing JavaScript source text.</span></div><div class="line" id="LC670">&nbsp;</div><div class="line" id="LC671"><span class="s">Key bindings:</span></div><div class="line" id="LC672">&nbsp;</div><div class="line" id="LC673"><span class="s">\\{javascript-mode-map}&quot;</span></div><div class="line" id="LC674">&nbsp;&nbsp;<span class="p">(</span><span class="nf">interactive</span><span class="p">)</span></div><div class="line" id="LC675">&nbsp;&nbsp;<span class="p">(</span><span class="nf">kill-all-local-variables</span><span class="p">)</span></div><div class="line" id="LC676">&nbsp;</div><div class="line" id="LC677">&nbsp;&nbsp;<span class="p">(</span><span class="nf">use-local-map</span> <span class="nv">javascript-mode-map</span><span class="p">)</span></div><div class="line" id="LC678">&nbsp;&nbsp;<span class="p">(</span><span class="nf">set-syntax-table</span> <span class="nv">javascript-mode-syntax-table</span><span class="p">)</span></div><div class="line" id="LC679">&nbsp;&nbsp;<span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">&#39;indent-line-function</span><span class="p">)</span> <span class="ss">&#39;javascript-indent-line</span><span class="p">)</span></div><div class="line" id="LC680">&nbsp;&nbsp;<span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">&#39;font-lock-defaults</span><span class="p">)</span> <span class="p">(</span><span class="nb">list </span><span class="nv">js-font-lock-keywords</span><span class="p">))</span></div><div class="line" id="LC681">&nbsp;</div><div class="line" id="LC682">&nbsp;&nbsp;<span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">&#39;parse-sexp-ignore-comments</span><span class="p">)</span> <span class="nv">t</span><span class="p">)</span> </div><div class="line" id="LC683">&nbsp;</div><div class="line" id="LC684">&nbsp;&nbsp;<span class="c1">;; Comments</span></div><div class="line" id="LC685">&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">comment-start</span> <span class="s">&quot;// &quot;</span><span class="p">)</span></div><div class="line" id="LC686">&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">comment-end</span> <span class="s">&quot;&quot;</span><span class="p">)</span></div><div class="line" id="LC687">&nbsp;&nbsp;<span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">&#39;fill-paragraph-function</span><span class="p">)</span> </div><div class="line" id="LC688">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ss">&#39;javascript-fill-paragraph</span><span class="p">)</span></div><div class="line" id="LC689">&nbsp;</div><div class="line" id="LC690">&nbsp;&nbsp;<span class="c1">;; Make c-mark-function work</span></div><div class="line" id="LC691">&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">c-nonsymbol-token-regexp</span> <span class="s">&quot;!=\\|%=\\|&amp;[&amp;=]\\|\\*[/=]\\|\\+[+=]\\|-[=-]\\|/[*/=]\\|&lt;\\(?:&lt;=\\|[&lt;=]\\)\\|==\\|&gt;\\(?:&gt;\\(?:&gt;=\\|[=&gt;]\\)\\|[=&gt;]\\)\\|\\^=\\||[=|]\\|[]!%&amp;(-,./:-?[{-~^-]&quot;</span></div><div class="line" id="LC692">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">c-stmt-delim-chars</span> <span class="s">&quot;^;{}?:&quot;</span></div><div class="line" id="LC693">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">c-syntactic-ws-end</span> <span class="s">&quot;[ \n&nbsp;&nbsp;</span></div><div class="line" id="LC694"><span class="s">\f/]&quot;</span></div><div class="line" id="LC695">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">c-syntactic-eol</span> <span class="s">&quot;\\(\\s \\|/\\*\\([^*\n</span></div><div class="line" id="LC696"><span class="s">]\\|\\*[^/\n</span></div><div class="line" id="LC697"><span class="s">]\\)*\\*/\\)*\\(\\(/\\*\\([^*\n</span></div><div class="line" id="LC698"><span class="s">]\\|\\*[^/\n</span></div><div class="line" id="LC699"><span class="s">]\\)*\\|\\\\\\)?$\\|//\\)&quot;</span><span class="p">)</span></div><div class="line" id="LC700">&nbsp;</div><div class="line" id="LC701">&nbsp;&nbsp;<span class="c1">;; Imenu</span></div><div class="line" id="LC702">&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">imenu-case-fold-search</span> <span class="nv">nil</span><span class="p">)</span></div><div class="line" id="LC703">&nbsp;&nbsp;<span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">&#39;imenu-generic-expression</span><span class="p">)</span></div><div class="line" id="LC704">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">js-imenu-generic-expression</span><span class="p">)</span></div><div class="line" id="LC705">&nbsp;</div><div class="line" id="LC706">&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">major-mode</span> <span class="ss">&#39;javascript-mode</span><span class="p">)</span></div><div class="line" id="LC707">&nbsp;&nbsp;<span class="p">(</span><span class="nf">setq</span> <span class="nv">mode-name</span> <span class="s">&quot;JavaScript&quot;</span><span class="p">)</span></div><div class="line" id="LC708">&nbsp;&nbsp;<span class="p">(</span><span class="nf">run-hooks</span> <span class="ss">&#39;javascript-mode-hook</span><span class="p">))</span></div></pre></div>
            
          </td>
        </tr>
      </table>
    
  </div>


      </div>
    </div>
    
  


  </div>

      
      
      <div class="push"></div>
    </div>
    
    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://github.com/guides/the-github-api">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="1.96324s from xc88-s00008">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> &copy;2009 | <a href="/site/terms">Terms of Service</a> | <a href="/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com"><img src="/images/modules/footer/engine_yard_logo.png" alt="Engine Yard" /></a>
          <div>
            Hosting provided by our<br /> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display:none;">
      This feature is coming soon.  Sit tight!
    </div>

    
        <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    var pageTracker = _gat._getTracker("UA-3769691-2");
    pageTracker._initData();
    pageTracker._trackPageview();
    </script>

    
  </body>
</html>

